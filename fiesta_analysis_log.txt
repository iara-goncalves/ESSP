/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/work2/lbuc/iara/conda_envs/pyorbit/lib/python3.10/site-packages/scipy/optimize/_minpack_py.py:1010: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
FIESTA Analysis for ESSP4 CCF Data
Data directory: /work2/lbuc/data/ESSP4/ESSP4
Output directory for plots: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures
Output directory for .dat files: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data
FIESTA modes: 5
Save plots: True
Loaded offsets: {'neid': -79.72803738588587, 'expres': -88.58011579897897, 'harps': 557.5629078011011, 'harpsn': 546.3759654699909}
Analyzing datasets: [1, 2, 3, 4, 5, 6, 7, 8, 9]

============================================================
Processing Dataset 1
============================================================

=== FIESTA Analysis for DS1 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432949.57
  Max: 896895.79
  Mean: 753831.89
  Range: 463946.22
  Deepest point: v=0.40 km/s, flux=432949.57
  Highest point: v=11.60 km/s, flux=896895.79
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432748.82
  Max: 896808.30
  Mean: 753735.36
  Range: 464059.48
  Deepest point: v=0.40 km/s, flux=432748.82
  Highest point: v=11.60 km/s, flux=896808.30
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432910.39
  Max: 897022.44
  Mean: 753756.41
  Range: 464112.05
  Deepest point: v=0.40 km/s, flux=432910.39
  Highest point: v=11.20 km/s, flux=897022.44
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5178
    CCF variation across observations: 0.000190
    CCF center variations: 0.2981 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 84 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22339
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45612.5  ...          0.17803                    5
1   0.041         32882.0  ...          0.07232                   13
2   0.082         14200.2  ...          0.01724                   54
3   0.123          3395.0  ...          0.00393                  237
4   0.164           750.9  ...          0.00132                  705
5   0.205            39.2  ...          0.00131                  711
6   0.246           124.0  ...          0.00116                  804
7   0.287            92.8  ...          0.00107                  873
8   0.328            78.7  ...          0.00099                  937
9   0.369            72.4  ...          0.00093                 1000
10  0.410            61.6  ...          0.00088                 1059
11  0.451            58.5  ...          0.00083                 1120
12  0.492            55.1  ...          0.00079                 1183
13  0.533            50.7  ...          0.00075                 1247
14  0.574            48.4  ...          0.00071                 1314
15  0.615            45.1  ...          0.00067                 1384
16  0.656            43.3  ...          0.00064                 1458
17  0.697            41.0  ...          0.00061                 1535
18  0.738            38.7  ...          0.00058                 1618
19  0.779            38.4  ...          0.00054                 1712
20  0.820            36.6  ...          0.00051                 1813
21  0.861            35.2  ...          0.00048                 1927
22  0.902            34.8  ...          0.00045                 2059
23  0.943            34.3  ...          0.00042                 2219
24  0.984            34.4  ...          0.00038                 2423
25  1.025            33.8  ...          0.00035                 2674
26  1.066            32.9  ...          0.00031                 3013
27  1.107            30.2  ...          0.00027                 3457
28  1.148            32.7  ...          0.00022                 4244
29  1.189            31.3  ...          0.00016                 5948
30  1.230            32.3  ...          0.00000    14640498419227706

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (84,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.70 to 4.85 m/s
  Final RV_reference RMS: 2.45 m/s
  Success! Processed 84 CCFs with 4 differential modes
  RV range: -5.7 to 4.8 m/s
  eMJD range: 59337.993481 to 59423.926247
  Activity indicator ranges:
    ΔRV_1: RMS = 2.65 m/s
    ΔRV_2: RMS = 4.20 m/s
    ΔRV_3: RMS = 11.81 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445665.51
  Max: 887914.89
  Mean: 747569.08
  Range: 442249.38
  Deepest point: v=0.80 km/s, flux=445665.51
  Highest point: v=11.60 km/s, flux=887914.89
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445595.33
  Max: 887719.58
  Mean: 747304.07
  Range: 442124.25
  Deepest point: v=0.40 km/s, flux=445595.33
  Highest point: v=11.60 km/s, flux=887719.58
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445673.44
  Max: 887633.92
  Mean: 747338.65
  Range: 441960.48
  Deepest point: v=0.40 km/s, flux=445673.44
  Highest point: v=11.60 km/s, flux=887633.92
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4983
    CCF variation across observations: 0.000271
    CCF center variations: 0.1491 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 24 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19553
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.02

In summary, the cut-off frequency is recommended to be 1.02 (k_max = 25)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         39816.7  ...          0.17052                    5
1   0.041         27912.1  ...          0.06803                   14
2   0.082         11809.6  ...          0.01590                   59
3   0.123          2759.1  ...          0.00383                  243
4   0.164           620.9  ...          0.00165                  566
5   0.205            77.3  ...          0.00159                  586
6   0.246           124.6  ...          0.00143                  652
7   0.287            97.5  ...          0.00132                  707
8   0.328            89.6  ...          0.00122                  763
9   0.369            79.3  ...          0.00114                  814
10  0.410            66.4  ...          0.00108                  865
11  0.451            61.9  ...          0.00102                  915
12  0.492            60.6  ...          0.00096                  969
13  0.533            55.4  ...          0.00091                 1023
14  0.574            50.2  ...          0.00087                 1075
15  0.615            49.5  ...          0.00082                 1133
16  0.656            45.2  ...          0.00078                 1192
17  0.697            43.2  ...          0.00074                 1253
18  0.738            41.7  ...          0.00071                 1321
19  0.779            39.9  ...          0.00067                 1395
20  0.820            39.4  ...          0.00063                 1479
21  0.861            36.8  ...          0.00060                 1564
22  0.902            37.3  ...          0.00056                 1675
23  0.943            35.1  ...          0.00052                 1790
24  0.984            38.9  ...          0.00047                 1975
25  1.025            38.6  ...          0.00042                 2212
26  1.066            32.8  ...          0.00038                 2459
27  1.107            30.8  ...          0.00034                 2769
28  1.148            36.0  ...          0.00027                 3454
29  1.189            33.6  ...          0.00019                 4862
30  1.230            34.0  ...          0.00000    17192882222403708

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (24,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.63 to 3.92 m/s
  Final RV_reference RMS: 2.24 m/s
  Success! Processed 24 CCFs with 4 differential modes
  RV range: -4.6 to 3.9 m/s
  eMJD range: 59399.074692 to 59422.081835
  Activity indicator ranges:
    ΔRV_1: RMS = 2.55 m/s
    ΔRV_2: RMS = 5.19 m/s
    ΔRV_3: RMS = 14.87 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398577.76
  Max: 766578.74
  Mean: 650627.23
  Range: 368000.98
  Deepest point: v=0.00 km/s, flux=398577.76
  Highest point: v=12.00 km/s, flux=766578.74
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398497.27
  Max: 766653.55
  Mean: 650865.99
  Range: 368156.28
  Deepest point: v=0.00 km/s, flux=398497.27
  Highest point: v=11.60 km/s, flux=766653.55
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398549.34
  Max: 766721.05
  Mean: 650727.29
  Range: 368171.71
  Deepest point: v=0.00 km/s, flux=398549.34
  Highest point: v=12.00 km/s, flux=766721.05
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4807
    CCF variation across observations: 0.000258
    CCF center variations: 0.1599 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 96 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16703
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32468.1  ...          0.16085                    6
1   0.041         22227.1  ...          0.06663                   14
2   0.082          9694.3  ...          0.01894                   49
3   0.123          2776.6  ...          0.00478                  196
4   0.164           603.0  ...          0.00267                  351
5   0.205           174.1  ...          0.00241                  389
6   0.246           168.0  ...          0.00214                  438
7   0.287           116.7  ...          0.00199                  471
8   0.328           110.5  ...          0.00185                  505
9   0.369            98.3  ...          0.00174                  539
10  0.410            90.0  ...          0.00163                  574
11  0.451            80.8  ...          0.00154                  607
12  0.492            76.6  ...          0.00146                  642
13  0.533            70.8  ...          0.00138                  677
14  0.574            65.5  ...          0.00131                  713
15  0.615            62.4  ...          0.00125                  751
16  0.656            59.7  ...          0.00118                  791
17  0.697            57.2  ...          0.00112                  835
18  0.738            54.4  ...          0.00106                  881
19  0.779            53.2  ...          0.00101                  931
20  0.820            52.2  ...          0.00095                  990
21  0.861            47.8  ...          0.00089                 1050
22  0.902            48.1  ...          0.00083                 1122
23  0.943            46.8  ...          0.00077                 1209
24  0.984            44.3  ...          0.00072                 1304
25  1.025            47.1  ...          0.00065                 1443
26  1.066            44.0  ...          0.00058                 1616
27  1.107            44.7  ...          0.00050                 1872
28  1.148            44.0  ...          0.00041                 2293
29  1.189            44.1  ...          0.00029                 3259
30  1.230            43.6  ...          0.00000    20873898362667372

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (96,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.41 to 5.21 m/s
  Final RV_reference RMS: 2.00 m/s
  Success! Processed 96 CCFs with 4 differential modes
  RV range: -5.4 to 5.2 m/s
  eMJD range: 59338.301795 to 59422.296261
  Activity indicator ranges:
    ΔRV_1: RMS = 1.97 m/s
    ΔRV_2: RMS = 3.41 m/s
    ΔRV_3: RMS = 10.59 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419991.51
  Max: 793536.33
  Mean: 675317.66
  Range: 373544.83
  Deepest point: v=0.00 km/s, flux=419991.51
  Highest point: v=12.00 km/s, flux=793536.33
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420054.13
  Max: 793519.14
  Mean: 675328.73
  Range: 373465.01
  Deepest point: v=0.00 km/s, flux=420054.13
  Highest point: v=12.00 km/s, flux=793519.14
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419995.03
  Max: 793726.55
  Mean: 675466.72
  Range: 373731.52
  Deepest point: v=0.00 km/s, flux=419995.03
  Highest point: v=12.00 km/s, flux=793726.55
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4709
    CCF variation across observations: 0.000154
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 84 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16016
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30301.3  ...          0.15979                    6
1   0.041         21119.0  ...          0.06311                   15
2   0.082          8751.1  ...          0.01667                   56
3   0.123          2334.8  ...          0.00383                  244
4   0.164           489.9  ...          0.00179                  522
5   0.205           105.7  ...          0.00164                  571
6   0.246           107.4  ...          0.00146                  639
7   0.287            78.4  ...          0.00136                  688
8   0.328            72.2  ...          0.00126                  740
9   0.369            63.9  ...          0.00118                  789
10  0.410            57.6  ...          0.00112                  837
11  0.451            52.8  ...          0.00105                  886
12  0.492            48.8  ...          0.00100                  935
13  0.533            46.0  ...          0.00095                  986
14  0.574            43.8  ...          0.00090                 1040
15  0.615            40.5  ...          0.00085                 1094
16  0.656            38.8  ...          0.00081                 1153
17  0.697            37.2  ...          0.00077                 1215
18  0.738            35.1  ...          0.00073                 1281
19  0.779            34.1  ...          0.00069                 1354
20  0.820            33.2  ...          0.00065                 1437
21  0.861            31.9  ...          0.00061                 1529
22  0.902            32.1  ...          0.00057                 1636
23  0.943            32.0  ...          0.00053                 1763
24  0.984            31.2  ...          0.00049                 1913
25  1.025            30.3  ...          0.00044                 2106
26  1.066            29.3  ...          0.00040                 2362
27  1.107            30.2  ...          0.00034                 2743
28  1.148            28.1  ...          0.00028                 3358
29  1.189            28.6  ...          0.00020                 4735
30  1.230            28.5  ...          0.00000    28849315382618232

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (84,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.75 to 4.47 m/s
  Final RV_reference RMS: 2.41 m/s
  Success! Processed 84 CCFs with 4 differential modes
  RV range: -4.8 to 4.5 m/s
  eMJD range: 59340.142771 to 59422.237326
  Activity indicator ranges:
    ΔRV_1: RMS = 2.11 m/s
    ΔRV_2: RMS = 3.27 m/s
    ΔRV_3: RMS = 10.74 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harpsn_fiesta_rv_gauss.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harpsn_fiesta_mode1.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harpsn_fiesta_mode2.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harpsn_fiesta_mode3.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harpsn_fiesta_mode4.dat (n_obs=84)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harps_fiesta_rv_gauss.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harps_fiesta_mode1.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harps_fiesta_mode2.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harps_fiesta_mode3.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_harps_fiesta_mode4.dat (n_obs=24)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_expres_fiesta_rv_gauss.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_expres_fiesta_mode1.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_expres_fiesta_mode2.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_expres_fiesta_mode3.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_expres_fiesta_mode4.dat (n_obs=96)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_neid_fiesta_rv_gauss.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_neid_fiesta_mode1.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_neid_fiesta_mode2.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_neid_fiesta_mode3.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS1_neid_fiesta_mode4.dat (n_obs=84)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS1...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS1_FIESTA_style.png
Completed analysis for DS1

============================================================
Processing Dataset 2
============================================================

=== FIESTA Analysis for DS2 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432482.04
  Max: 896563.23
  Mean: 753589.45
  Range: 464081.19
  Deepest point: v=0.40 km/s, flux=432482.04
  Highest point: v=11.60 km/s, flux=896563.23
CCF 0 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432799.93
  Max: 896887.52
  Mean: 753720.89
  Range: 464087.59
  Deepest point: v=0.40 km/s, flux=432799.93
  Highest point: v=11.60 km/s, flux=896887.52
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432980.38
  Max: 896823.25
  Mean: 753865.56
  Range: 463842.88
  Deepest point: v=0.40 km/s, flux=432980.38
  Highest point: v=11.20 km/s, flux=896823.25
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5181
    CCF variation across observations: 0.000203
    CCF center variations: 0.2797 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 90 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22339
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45564.2  ...          0.17805                    5
1   0.041         32837.1  ...          0.07233                   13
2   0.082         14167.5  ...          0.01724                   54
3   0.123          3387.1  ...          0.00393                  237
4   0.164           750.4  ...          0.00131                  710
5   0.205            40.8  ...          0.00130                  718
6   0.246           120.2  ...          0.00116                  804
7   0.287            93.0  ...          0.00107                  871
8   0.328            79.3  ...          0.00100                  934
9   0.369            71.7  ...          0.00093                  999
10  0.410            63.5  ...          0.00088                 1060
11  0.451            58.1  ...          0.00083                 1122
12  0.492            53.4  ...          0.00079                 1184
13  0.533            51.2  ...          0.00075                 1249
14  0.574            47.7  ...          0.00071                 1315
15  0.615            45.0  ...          0.00067                 1385
16  0.656            42.3  ...          0.00064                 1458
17  0.697            41.0  ...          0.00061                 1534
18  0.738            39.9  ...          0.00057                 1620
19  0.779            37.7  ...          0.00054                 1709
20  0.820            36.3  ...          0.00051                 1810
21  0.861            35.3  ...          0.00048                 1924
22  0.902            34.4  ...          0.00045                 2053
23  0.943            34.4  ...          0.00042                 2211
24  0.984            33.4  ...          0.00039                 2402
25  1.025            36.1  ...          0.00035                 2668
26  1.066            29.7  ...          0.00031                 2979
27  1.107            33.4  ...          0.00027                 3443
28  1.148            33.4  ...          0.00022                 4261
29  1.189            29.3  ...          0.00016                 5912
30  1.230            32.9  ...          0.00000    14390165796791276

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (90,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.52 to 6.66 m/s
  Final RV_reference RMS: 2.50 m/s
  Success! Processed 90 CCFs with 4 differential modes
  RV range: -5.5 to 6.7 m/s
  eMJD range: 59331.910942 to 59419.951685
  Activity indicator ranges:
    ΔRV_1: RMS = 3.18 m/s
    ΔRV_2: RMS = 4.39 m/s
    ΔRV_3: RMS = 13.03 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445897.62
  Max: 887622.00
  Mean: 747092.63
  Range: 441724.38
  Deepest point: v=0.80 km/s, flux=445897.62
  Highest point: v=12.00 km/s, flux=887622.00
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446094.00
  Max: 887860.70
  Mean: 747449.55
  Range: 441766.69
  Deepest point: v=0.80 km/s, flux=446094.00
  Highest point: v=12.00 km/s, flux=887860.70
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445820.17
  Max: 887606.16
  Mean: 747329.23
  Range: 441785.99
  Deepest point: v=0.80 km/s, flux=445820.17
  Highest point: v=11.60 km/s, flux=887606.16
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4983
    CCF variation across observations: 0.000261
    CCF center variations: 0.1781 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 33 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19899
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40341.1  ...          0.17053                    5
1   0.041         28268.0  ...          0.06805                   14
2   0.082         11978.6  ...          0.01591                   59
3   0.123          2792.2  ...          0.00384                  243
4   0.164           627.8  ...          0.00164                  567
5   0.205            78.4  ...          0.00159                  587
6   0.246           129.2  ...          0.00142                  655
7   0.287            96.9  ...          0.00131                  709
8   0.328            89.2  ...          0.00122                  764
9   0.369            75.9  ...          0.00114                  814
10  0.410            69.0  ...          0.00108                  865
11  0.451            62.5  ...          0.00102                  914
12  0.492            58.8  ...          0.00097                  964
13  0.533            58.6  ...          0.00091                 1023
14  0.574            51.8  ...          0.00086                 1079
15  0.615            50.5  ...          0.00082                 1137
16  0.656            46.4  ...          0.00078                 1195
17  0.697            45.4  ...          0.00074                 1258
18  0.738            42.7  ...          0.00070                 1326
19  0.779            40.1  ...          0.00067                 1397
20  0.820            40.2  ...          0.00063                 1481
21  0.861            36.6  ...          0.00060                 1566
22  0.902            38.2  ...          0.00056                 1676
23  0.943            35.1  ...          0.00052                 1782
24  0.984            40.2  ...          0.00047                 1987
25  1.025            38.8  ...          0.00042                 2207
26  1.066            33.3  ...          0.00038                 2450
27  1.107            32.0  ...          0.00034                 2771
28  1.148            36.5  ...          0.00027                 3452
29  1.189            34.4  ...          0.00019                 4857
30  1.230            34.5  ...          0.00000    24542612109763032

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (33,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.64 to 3.94 m/s
  Final RV_reference RMS: 1.81 m/s
  Success! Processed 33 CCFs with 4 differential modes
  RV range: -4.6 to 3.9 m/s
  eMJD range: 59396.187173 to 59415.076140
  Activity indicator ranges:
    ΔRV_1: RMS = 2.47 m/s
    ΔRV_2: RMS = 5.20 m/s
    ΔRV_3: RMS = 13.01 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398658.08
  Max: 766423.12
  Mean: 650748.58
  Range: 367765.04
  Deepest point: v=0.00 km/s, flux=398658.08
  Highest point: v=12.00 km/s, flux=766423.12
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398375.16
  Max: 766259.24
  Mean: 650654.66
  Range: 367884.08
  Deepest point: v=0.00 km/s, flux=398375.16
  Highest point: v=12.00 km/s, flux=766259.24
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398692.62
  Max: 766554.49
  Mean: 650565.81
  Range: 367861.87
  Deepest point: v=0.00 km/s, flux=398692.62
  Highest point: v=12.00 km/s, flux=766554.49
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4810
    CCF variation across observations: 0.000260
    CCF center variations: 0.1634 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 110 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16600
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32469.4  ...          0.16084                    6
1   0.041         22232.3  ...          0.06662                   14
2   0.082          9697.3  ...          0.01894                   49
3   0.123          2772.9  ...          0.00478                  196
4   0.164           597.9  ...          0.00268                  350
5   0.205           171.2  ...          0.00242                  387
6   0.246           168.5  ...          0.00215                  436
7   0.287           118.7  ...          0.00199                  469
8   0.328           112.2  ...          0.00185                  505
9   0.369            96.4  ...          0.00174                  538
10  0.410            88.9  ...          0.00164                  572
11  0.451            81.2  ...          0.00154                  606
12  0.492            77.3  ...          0.00146                  642
13  0.533            70.0  ...          0.00138                  677
14  0.574            64.6  ...          0.00131                  713
15  0.615            61.8  ...          0.00125                  750
16  0.656            59.2  ...          0.00119                  790
17  0.697            57.7  ...          0.00112                  834
18  0.738            55.2  ...          0.00106                  880
19  0.779            53.0  ...          0.00101                  932
20  0.820            51.0  ...          0.00095                  988
21  0.861            48.0  ...          0.00089                 1049
22  0.902            47.0  ...          0.00083                 1121
23  0.943            46.5  ...          0.00078                 1207
24  0.984            45.3  ...          0.00072                 1308
25  1.025            45.8  ...          0.00065                 1441
26  1.066            45.3  ...          0.00058                 1620
27  1.107            44.0  ...          0.00050                 1878
28  1.148            43.8  ...          0.00041                 2310
29  1.189            43.0  ...          0.00029                 3257
30  1.230            43.4  ...          0.00000    19408030095864552

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (110,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -3.92 to 4.55 m/s
  Final RV_reference RMS: 1.97 m/s
  Success! Processed 110 CCFs with 4 differential modes
  RV range: -3.9 to 4.5 m/s
  eMJD range: 59336.304991 to 59420.287906
  Activity indicator ranges:
    ΔRV_1: RMS = 2.20 m/s
    ΔRV_2: RMS = 3.94 m/s
    ΔRV_3: RMS = 10.98 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419918.62
  Max: 793645.33
  Mean: 675431.99
  Range: 373726.71
  Deepest point: v=0.00 km/s, flux=419918.62
  Highest point: v=12.00 km/s, flux=793645.33
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420101.95
  Max: 793663.31
  Mean: 675586.85
  Range: 373561.36
  Deepest point: v=0.00 km/s, flux=420101.95
  Highest point: v=12.00 km/s, flux=793663.31
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420088.06
  Max: 793624.30
  Mean: 675443.85
  Range: 373536.23
  Deepest point: v=0.00 km/s, flux=420088.06
  Highest point: v=12.00 km/s, flux=793624.30
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4710
    CCF variation across observations: 0.000163
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 90 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 15899
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30249.6  ...          0.15979                    6
1   0.041         21058.9  ...          0.06311                   15
2   0.082          8732.7  ...          0.01667                   56
3   0.123          2329.7  ...          0.00383                  244
4   0.164           487.5  ...          0.00179                  521
5   0.205           104.7  ...          0.00164                  570
6   0.246           105.5  ...          0.00147                  638
7   0.287            77.4  ...          0.00136                  686
8   0.328            72.2  ...          0.00126                  739
9   0.369            63.0  ...          0.00119                  787
10  0.410            57.8  ...          0.00112                  836
11  0.451            52.3  ...          0.00106                  884
12  0.492            48.5  ...          0.00100                  933
13  0.533            45.7  ...          0.00095                  984
14  0.574            43.0  ...          0.00090                 1037
15  0.615            40.8  ...          0.00086                 1092
16  0.656            38.9  ...          0.00081                 1152
17  0.697            36.6  ...          0.00077                 1213
18  0.738            35.4  ...          0.00073                 1280
19  0.779            34.2  ...          0.00069                 1353
20  0.820            32.9  ...          0.00065                 1435
21  0.861            31.6  ...          0.00061                 1526
22  0.902            31.7  ...          0.00057                 1632
23  0.943            32.1  ...          0.00053                 1761
24  0.984            29.6  ...          0.00049                 1912
25  1.025            29.2  ...          0.00044                 2106
26  1.066            28.2  ...          0.00039                 2367
27  1.107            29.5  ...          0.00034                 2746
28  1.148            28.1  ...          0.00028                 3363
29  1.189            28.4  ...          0.00020                 4753
30  1.230            28.5  ...          0.00000    18050352465369932

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (90,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.06 to 3.64 m/s
  Final RV_reference RMS: 1.58 m/s
  Success! Processed 90 CCFs with 4 differential modes
  RV range: -4.1 to 3.6 m/s
  eMJD range: 59332.207998 to 59420.195294
  Activity indicator ranges:
    ΔRV_1: RMS = 2.06 m/s
    ΔRV_2: RMS = 3.88 m/s
    ΔRV_3: RMS = 10.58 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harpsn_fiesta_rv_gauss.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harpsn_fiesta_mode1.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harpsn_fiesta_mode2.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harpsn_fiesta_mode3.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harpsn_fiesta_mode4.dat (n_obs=90)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harps_fiesta_rv_gauss.dat (n_obs=33)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harps_fiesta_mode1.dat (n_obs=33)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harps_fiesta_mode2.dat (n_obs=33)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harps_fiesta_mode3.dat (n_obs=33)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_harps_fiesta_mode4.dat (n_obs=33)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_expres_fiesta_rv_gauss.dat (n_obs=110)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_expres_fiesta_mode1.dat (n_obs=110)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_expres_fiesta_mode2.dat (n_obs=110)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_expres_fiesta_mode3.dat (n_obs=110)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_expres_fiesta_mode4.dat (n_obs=110)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_neid_fiesta_rv_gauss.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_neid_fiesta_mode1.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_neid_fiesta_mode2.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_neid_fiesta_mode3.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS2_neid_fiesta_mode4.dat (n_obs=90)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS2...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS2_FIESTA_style.png
Completed analysis for DS2

============================================================
Processing Dataset 3
============================================================

=== FIESTA Analysis for DS3 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432829.03
  Max: 896926.58
  Mean: 754023.40
  Range: 464097.55
  Deepest point: v=0.40 km/s, flux=432829.03
  Highest point: v=11.60 km/s, flux=896926.58
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 433112.99
  Max: 896621.76
  Mean: 753941.72
  Range: 463508.76
  Deepest point: v=0.40 km/s, flux=433112.99
  Highest point: v=11.60 km/s, flux=896621.76
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432890.77
  Max: 896724.76
  Mean: 753846.64
  Range: 463834.00
  Deepest point: v=0.40 km/s, flux=432890.77
  Highest point: v=10.80 km/s, flux=896724.76
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5180
    CCF variation across observations: 0.000212
    CCF center variations: 0.2659 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 96 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22422
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45826.0  ...          0.17804                    5
1   0.041         33051.8  ...          0.07232                   13
2   0.082         14266.2  ...          0.01723                   54
3   0.123          3410.8  ...          0.00394                  237
4   0.164           752.3  ...          0.00132                  706
5   0.205            40.5  ...          0.00131                  713
6   0.246           121.2  ...          0.00116                  800
7   0.287            93.4  ...          0.00107                  868
8   0.328            78.6  ...          0.00100                  930
9   0.369            71.4  ...          0.00094                  993
10  0.410            65.4  ...          0.00088                 1055
11  0.451            60.7  ...          0.00083                 1118
12  0.492            55.5  ...          0.00079                 1182
13  0.533            51.6  ...          0.00075                 1248
14  0.574            48.6  ...          0.00071                 1316
15  0.615            45.6  ...          0.00067                 1385
16  0.656            42.7  ...          0.00064                 1459
17  0.697            40.4  ...          0.00061                 1535
18  0.738            39.8  ...          0.00058                 1619
19  0.779            38.3  ...          0.00054                 1713
20  0.820            36.4  ...          0.00051                 1813
21  0.861            35.5  ...          0.00048                 1926
22  0.902            34.3  ...          0.00045                 2055
23  0.943            34.7  ...          0.00042                 2210
24  0.984            33.2  ...          0.00039                 2408
25  1.025            34.7  ...          0.00035                 2667
26  1.066            32.4  ...          0.00031                 2985
27  1.107            32.7  ...          0.00027                 3449
28  1.148            33.0  ...          0.00022                 4252
29  1.189            32.4  ...          0.00016                 5939
30  1.230            32.3  ...          0.00000    14083715552810254

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (96,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.16 to 5.99 m/s
  Final RV_reference RMS: 2.16 m/s
  Success! Processed 96 CCFs with 4 differential modes
  RV range: -5.2 to 6.0 m/s
  eMJD range: 59332.006941 to 59420.055097
  Activity indicator ranges:
    ΔRV_1: RMS = 2.77 m/s
    ΔRV_2: RMS = 3.97 m/s
    ΔRV_3: RMS = 12.97 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445350.61
  Max: 887813.42
  Mean: 747100.32
  Range: 442462.81
  Deepest point: v=0.40 km/s, flux=445350.61
  Highest point: v=12.00 km/s, flux=887813.42
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445506.11
  Max: 887756.43
  Mean: 747200.45
  Range: 442250.32
  Deepest point: v=0.40 km/s, flux=445506.11
  Highest point: v=12.00 km/s, flux=887756.43
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445819.73
  Max: 887830.58
  Mean: 747438.60
  Range: 442010.85
  Deepest point: v=0.80 km/s, flux=445819.73
  Highest point: v=12.00 km/s, flux=887830.58
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4984
    CCF variation across observations: 0.000270
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 18 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19878
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 0.98

In summary, the cut-off frequency is recommended to be 0.98 (k_max = 24)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40380.6  ...          0.17056                    5
1   0.041         28300.5  ...          0.06806                   14
2   0.082         11968.7  ...          0.01590                   59
3   0.123          2800.8  ...          0.00381                  244
4   0.164           622.5  ...          0.00161                  577
5   0.205            76.8  ...          0.00156                  598
6   0.246           126.8  ...          0.00139                  671
7   0.287            95.7  ...          0.00128                  726
8   0.328            86.5  ...          0.00119                  782
9   0.369            76.5  ...          0.00112                  832
10  0.410            69.1  ...          0.00105                  884
11  0.451            60.2  ...          0.00100                  929
12  0.492            57.6  ...          0.00095                  977
13  0.533            56.6  ...          0.00090                 1035
14  0.574            52.3  ...          0.00085                 1094
15  0.615            49.3  ...          0.00081                 1153
16  0.656            45.9  ...          0.00077                 1211
17  0.697            41.3  ...          0.00074                 1267
18  0.738            42.7  ...          0.00070                 1337
19  0.779            40.1  ...          0.00066                 1410
20  0.820            40.4  ...          0.00062                 1499
21  0.861            37.1  ...          0.00059                 1585
22  0.902            37.8  ...          0.00055                 1694
23  0.943            35.9  ...          0.00052                 1800
24  0.984            40.3  ...          0.00046                 2006
25  1.025            38.8  ...          0.00042                 2232
26  1.066            32.8  ...          0.00038                 2479
27  1.107            30.4  ...          0.00033                 2793
28  1.148            36.2  ...          0.00027                 3489
29  1.189            33.9  ...          0.00019                 4921
30  1.230            33.7  ...          0.00000    21236000044061720

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (18,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -3.78 to 5.49 m/s
  Final RV_reference RMS: 2.35 m/s
  Success! Processed 18 CCFs with 4 differential modes
  RV range: -3.8 to 5.5 m/s
  eMJD range: 59400.261026 to 59415.219886
  Activity indicator ranges:
    ΔRV_1: RMS = 2.57 m/s
    ΔRV_2: RMS = 4.29 m/s
    ΔRV_3: RMS = 14.03 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398581.33
  Max: 766455.05
  Mean: 650787.45
  Range: 367873.71
  Deepest point: v=0.00 km/s, flux=398581.33
  Highest point: v=12.00 km/s, flux=766455.05
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398420.94
  Max: 766601.53
  Mean: 650763.67
  Range: 368180.59
  Deepest point: v=0.00 km/s, flux=398420.94
  Highest point: v=12.00 km/s, flux=766601.53
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398377.15
  Max: 766259.56
  Mean: 650655.60
  Range: 367882.41
  Deepest point: v=0.00 km/s, flux=398377.15
  Highest point: v=12.00 km/s, flux=766259.56
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4810
    CCF variation across observations: 0.000256
    CCF center variations: 0.1374 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 122 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16675
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32448.5  ...          0.16082                    6
1   0.041         22168.0  ...          0.06660                   14
2   0.082          9668.2  ...          0.01893                   49
3   0.123          2772.2  ...          0.00478                  196
4   0.164           598.6  ...          0.00267                  351
5   0.205           173.9  ...          0.00241                  389
6   0.246           168.3  ...          0.00214                  438
7   0.287           117.6  ...          0.00199                  471
8   0.328           111.0  ...          0.00185                  506
9   0.369            96.5  ...          0.00173                  540
10  0.410            89.3  ...          0.00163                  574
11  0.451            80.1  ...          0.00154                  607
12  0.492            76.8  ...          0.00146                  643
13  0.533            69.1  ...          0.00138                  677
14  0.574            64.6  ...          0.00132                  711
15  0.615            63.4  ...          0.00125                  750
16  0.656            59.1  ...          0.00119                  790
17  0.697            56.4  ...          0.00112                  833
18  0.738            56.3  ...          0.00106                  881
19  0.779            53.1  ...          0.00100                  933
20  0.820            49.7  ...          0.00095                  987
21  0.861            48.4  ...          0.00089                 1048
22  0.902            47.8  ...          0.00084                 1120
23  0.943            46.5  ...          0.00078                 1204
24  0.984            46.7  ...          0.00072                 1307
25  1.025            45.7  ...          0.00065                 1438
26  1.066            45.3  ...          0.00058                 1620
27  1.107            43.5  ...          0.00050                 1876
28  1.148            43.9  ...          0.00041                 2307
29  1.189            43.5  ...          0.00029                 3271
30  1.230            43.1  ...          0.00000    22043230408853900

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (122,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.61 to 5.02 m/s
  Final RV_reference RMS: 1.90 m/s
  Success! Processed 122 CCFs with 4 differential modes
  RV range: -5.6 to 5.0 m/s
  eMJD range: 59336.400193 to 59420.325989
  Activity indicator ranges:
    ΔRV_1: RMS = 2.30 m/s
    ΔRV_2: RMS = 4.00 m/s
    ΔRV_3: RMS = 9.99 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420034.60
  Max: 793740.33
  Mean: 675499.58
  Range: 373705.73
  Deepest point: v=0.00 km/s, flux=420034.60
  Highest point: v=12.00 km/s, flux=793740.33
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420457.17
  Max: 793792.40
  Mean: 675612.94
  Range: 373335.22
  Deepest point: v=0.00 km/s, flux=420457.17
  Highest point: v=12.00 km/s, flux=793792.40
CCF 1 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420225.97
  Max: 793466.25
  Mean: 675422.16
  Range: 373240.29
  Deepest point: v=0.00 km/s, flux=420225.97
  Highest point: v=12.00 km/s, flux=793466.25
CCF 2 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4710
    CCF variation across observations: 0.000139
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 87 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 15892
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30356.4  ...          0.15979                    6
1   0.041         21160.5  ...          0.06311                   15
2   0.082          8774.5  ...          0.01667                   56
3   0.123          2337.4  ...          0.00384                  244
4   0.164           487.9  ...          0.00179                  522
5   0.205           104.8  ...          0.00164                  571
6   0.246           106.0  ...          0.00146                  639
7   0.287            78.0  ...          0.00136                  688
8   0.328            71.6  ...          0.00126                  740
9   0.369            62.7  ...          0.00119                  788
10  0.410            57.8  ...          0.00112                  837
11  0.451            52.3  ...          0.00106                  885
12  0.492            48.4  ...          0.00100                  934
13  0.533            46.0  ...          0.00095                  985
14  0.574            42.8  ...          0.00090                 1038
15  0.615            40.6  ...          0.00086                 1092
16  0.656            38.7  ...          0.00081                 1152
17  0.697            36.4  ...          0.00077                 1212
18  0.738            35.3  ...          0.00073                 1279
19  0.779            34.0  ...          0.00069                 1352
20  0.820            33.0  ...          0.00065                 1433
21  0.861            31.5  ...          0.00061                 1523
22  0.902            31.8  ...          0.00057                 1630
23  0.943            31.8  ...          0.00053                 1759
24  0.984            31.5  ...          0.00049                 1912
25  1.025            29.6  ...          0.00044                 2104
26  1.066            28.8  ...          0.00040                 2362
27  1.107            29.6  ...          0.00034                 2744
28  1.148            28.2  ...          0.00028                 3362
29  1.189            28.1  ...          0.00020                 4739
30  1.230            28.5  ...          0.00000    22560284964121804

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (87,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.47 to 4.49 m/s
  Final RV_reference RMS: 1.79 m/s
  Success! Processed 87 CCFs with 4 differential modes
  RV range: -4.5 to 4.5 m/s
  eMJD range: 59332.306663 to 59420.355373
  Activity indicator ranges:
    ΔRV_1: RMS = 2.15 m/s
    ΔRV_2: RMS = 3.66 m/s
    ΔRV_3: RMS = 9.26 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harpsn_fiesta_rv_gauss.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harpsn_fiesta_mode1.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harpsn_fiesta_mode2.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harpsn_fiesta_mode3.dat (n_obs=96)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harpsn_fiesta_mode4.dat (n_obs=96)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harps_fiesta_rv_gauss.dat (n_obs=18)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harps_fiesta_mode1.dat (n_obs=18)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harps_fiesta_mode2.dat (n_obs=18)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harps_fiesta_mode3.dat (n_obs=18)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_harps_fiesta_mode4.dat (n_obs=18)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_expres_fiesta_rv_gauss.dat (n_obs=122)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_expres_fiesta_mode1.dat (n_obs=122)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_expres_fiesta_mode2.dat (n_obs=122)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_expres_fiesta_mode3.dat (n_obs=122)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_expres_fiesta_mode4.dat (n_obs=122)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_neid_fiesta_rv_gauss.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_neid_fiesta_mode1.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_neid_fiesta_mode2.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_neid_fiesta_mode3.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS3_neid_fiesta_mode4.dat (n_obs=87)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS3...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS3_FIESTA_style.png
Completed analysis for DS3

============================================================
Processing Dataset 4
============================================================

=== FIESTA Analysis for DS4 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 433138.42
  Max: 896622.17
  Mean: 753941.79
  Range: 463483.75
  Deepest point: v=0.40 km/s, flux=433138.42
  Highest point: v=11.60 km/s, flux=896622.17
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432988.72
  Max: 896796.58
  Mean: 753615.84
  Range: 463807.86
  Deepest point: v=0.40 km/s, flux=432988.72
  Highest point: v=11.60 km/s, flux=896796.58
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432499.62
  Max: 896562.18
  Mean: 753588.12
  Range: 464062.56
  Deepest point: v=0.40 km/s, flux=432499.62
  Highest point: v=11.60 km/s, flux=896562.18
CCF 2 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5176
    CCF variation across observations: 0.000179
    CCF center variations: 0.3115 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 84 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22403
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45793.0  ...          0.17805                    5
1   0.041         32994.0  ...          0.07231                   13
2   0.082         14240.9  ...          0.01723                   54
3   0.123          3404.9  ...          0.00393                  237
4   0.164           751.0  ...          0.00131                  709
5   0.205            40.5  ...          0.00130                  717
6   0.246           119.7  ...          0.00116                  802
7   0.287            93.2  ...          0.00107                  871
8   0.328            80.2  ...          0.00100                  935
9   0.369            72.4  ...          0.00093                  999
10  0.410            65.6  ...          0.00088                 1062
11  0.451            58.0  ...          0.00083                 1121
12  0.492            54.7  ...          0.00079                 1181
13  0.533            50.7  ...          0.00075                 1244
14  0.574            48.6  ...          0.00071                 1312
15  0.615            45.6  ...          0.00067                 1381
16  0.656            43.0  ...          0.00064                 1455
17  0.697            41.1  ...          0.00061                 1532
18  0.738            39.9  ...          0.00058                 1618
19  0.779            37.8  ...          0.00054                 1711
20  0.820            36.3  ...          0.00051                 1812
21  0.861            34.9  ...          0.00048                 1926
22  0.902            34.4  ...          0.00045                 2057
23  0.943            34.5  ...          0.00042                 2214
24  0.984            34.4  ...          0.00039                 2404
25  1.025            34.9  ...          0.00035                 2662
26  1.066            31.2  ...          0.00031                 2977
27  1.107            33.7  ...          0.00027                 3450
28  1.148            33.2  ...          0.00022                 4255
29  1.189            31.3  ...          0.00016                 5966
30  1.230            32.1  ...          0.00000    24969335702487816

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (84,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.07 to 8.25 m/s
  Final RV_reference RMS: 3.07 m/s
  Success! Processed 84 CCFs with 4 differential modes
  RV range: -5.1 to 8.3 m/s
  eMJD range: 59332.426929 to 59424.415942
  Activity indicator ranges:
    ΔRV_1: RMS = 2.53 m/s
    ΔRV_2: RMS = 4.75 m/s
    ΔRV_3: RMS = 13.63 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445701.29
  Max: 887445.12
  Mean: 747142.80
  Range: 441743.83
  Deepest point: v=0.80 km/s, flux=445701.29
  Highest point: v=12.00 km/s, flux=887445.12
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445508.16
  Max: 887647.35
  Mean: 747264.57
  Range: 442139.19
  Deepest point: v=0.40 km/s, flux=445508.16
  Highest point: v=12.00 km/s, flux=887647.35
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445627.91
  Max: 887758.76
  Mean: 747335.70
  Range: 442130.85
  Deepest point: v=0.40 km/s, flux=445627.91
  Highest point: v=12.00 km/s, flux=887758.76
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4985
    CCF variation across observations: 0.000258
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 24 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19639
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.02

In summary, the cut-off frequency is recommended to be 1.02 (k_max = 25)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40250.2  ...          0.17054                    5
1   0.041         28211.8  ...          0.06809                   14
2   0.082         11945.4  ...          0.01591                   59
3   0.123          2785.4  ...          0.00382                  244
4   0.164           622.1  ...          0.00166                  562
5   0.205            75.5  ...          0.00160                  582
6   0.246           127.0  ...          0.00143                  650
7   0.287            97.9  ...          0.00133                  702
8   0.328            91.4  ...          0.00123                  759
9   0.369            77.7  ...          0.00115                  813
10  0.410            67.7  ...          0.00108                  862
11  0.451            60.7  ...          0.00102                  910
12  0.492            60.4  ...          0.00097                  962
13  0.533            53.7  ...          0.00092                 1013
14  0.574            52.5  ...          0.00087                 1071
15  0.615            48.7  ...          0.00083                 1126
16  0.656            44.0  ...          0.00079                 1181
17  0.697            43.6  ...          0.00075                 1244
18  0.738            42.9  ...          0.00071                 1311
19  0.779            40.0  ...          0.00067                 1384
20  0.820            40.2  ...          0.00063                 1469
21  0.861            36.6  ...          0.00060                 1552
22  0.902            38.2  ...          0.00056                 1662
23  0.943            35.0  ...          0.00053                 1772
24  0.984            42.2  ...          0.00047                 1963
25  1.025            38.5  ...          0.00043                 2192
26  1.066            32.7  ...          0.00038                 2435
27  1.107            31.2  ...          0.00034                 2745
28  1.148            36.4  ...          0.00027                 3426
29  1.189            34.0  ...          0.00019                 4827
30  1.230            34.6  ...          0.00000    28220698650461420

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (24,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -2.69 to 3.03 m/s
  Final RV_reference RMS: 1.46 m/s
  Success! Processed 24 CCFs with 4 differential modes
  RV range: -2.7 to 3.0 m/s
  eMJD range: 59400.711146 to 59423.697202
  Activity indicator ranges:
    ΔRV_1: RMS = 1.91 m/s
    ΔRV_2: RMS = 3.54 m/s
    ΔRV_3: RMS = 14.75 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398869.66
  Max: 766412.48
  Mean: 650927.76
  Range: 367542.82
  Deepest point: v=0.00 km/s, flux=398869.66
  Highest point: v=12.00 km/s, flux=766412.48
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398596.12
  Max: 766538.44
  Mean: 650856.98
  Range: 367942.33
  Deepest point: v=0.00 km/s, flux=398596.12
  Highest point: v=12.00 km/s, flux=766538.44
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398789.24
  Max: 766375.17
  Mean: 650957.78
  Range: 367585.94
  Deepest point: v=0.00 km/s, flux=398789.24
  Highest point: v=12.00 km/s, flux=766375.17
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4810
    CCF variation across observations: 0.000267
    CCF center variations: 0.1506 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 93 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16568
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32381.0  ...          0.16082                    6
1   0.041         22144.9  ...          0.06659                   14
2   0.082          9644.8  ...          0.01892                   49
3   0.123          2763.9  ...          0.00477                  196
4   0.164           595.5  ...          0.00266                  352
5   0.205           172.1  ...          0.00240                  390
6   0.246           166.7  ...          0.00213                  439
7   0.287           116.9  ...          0.00198                  472
8   0.328           109.8  ...          0.00184                  508
9   0.369            96.4  ...          0.00173                  541
10  0.410            88.2  ...          0.00163                  576
11  0.451            80.9  ...          0.00154                  610
12  0.492            75.9  ...          0.00145                  645
13  0.533            69.0  ...          0.00138                  680
14  0.574            66.1  ...          0.00131                  716
15  0.615            61.6  ...          0.00124                  753
16  0.656            57.9  ...          0.00118                  792
17  0.697            56.3  ...          0.00112                  835
18  0.738            53.4  ...          0.00106                  882
19  0.779            51.9  ...          0.00100                  933
20  0.820            49.7  ...          0.00095                  989
21  0.861            48.8  ...          0.00089                 1051
22  0.902            47.4  ...          0.00083                 1125
23  0.943            45.5  ...          0.00077                 1209
24  0.984            44.1  ...          0.00072                 1307
25  1.025            45.9  ...          0.00065                 1441
26  1.066            44.1  ...          0.00058                 1613
27  1.107            44.2  ...          0.00050                 1873
28  1.148            43.4  ...          0.00041                 2294
29  1.189            43.4  ...          0.00029                 3253
30  1.230            43.4  ...          0.00000    21521475122055752

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (93,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.67 to 7.83 m/s
  Final RV_reference RMS: 3.11 m/s
  Success! Processed 93 CCFs with 4 differential modes
  RV range: -4.7 to 7.8 m/s
  eMJD range: 59336.729598 to 59421.812232
  Activity indicator ranges:
    ΔRV_1: RMS = 2.34 m/s
    ΔRV_2: RMS = 3.76 m/s
    ΔRV_3: RMS = 11.86 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420142.91
  Max: 793885.40
  Mean: 675433.59
  Range: 373742.49
  Deepest point: v=0.00 km/s, flux=420142.91
  Highest point: v=12.00 km/s, flux=793885.40
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420300.27
  Max: 793875.02
  Mean: 675603.07
  Range: 373574.75
  Deepest point: v=0.00 km/s, flux=420300.27
  Highest point: v=12.00 km/s, flux=793875.02
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420190.33
  Max: 793711.49
  Mean: 675366.69
  Range: 373521.15
  Deepest point: v=0.00 km/s, flux=420190.33
  Highest point: v=12.00 km/s, flux=793711.49
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4709
    CCF variation across observations: 0.000153
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 78 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16073
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30455.2  ...          0.15979                    6
1   0.041         21238.4  ...          0.06310                   15
2   0.082          8819.7  ...          0.01667                   56
3   0.123          2349.8  ...          0.00384                  243
4   0.164           491.6  ...          0.00180                  520
5   0.205           107.9  ...          0.00164                  570
6   0.246           107.5  ...          0.00146                  638
7   0.287            78.6  ...          0.00136                  686
8   0.328            73.5  ...          0.00127                  738
9   0.369            64.0  ...          0.00119                  786
10  0.410            58.3  ...          0.00112                  835
11  0.451            53.6  ...          0.00106                  884
12  0.492            49.2  ...          0.00100                  933
13  0.533            46.2  ...          0.00095                  984
14  0.574            43.0  ...          0.00090                 1036
15  0.615            41.3  ...          0.00086                 1091
16  0.656            39.6  ...          0.00081                 1150
17  0.697            36.9  ...          0.00077                 1210
18  0.738            35.9  ...          0.00073                 1278
19  0.779            34.2  ...          0.00069                 1350
20  0.820            33.8  ...          0.00065                 1433
21  0.861            32.2  ...          0.00061                 1524
22  0.902            31.4  ...          0.00057                 1627
23  0.943            33.4  ...          0.00053                 1762
24  0.984            27.5  ...          0.00049                 1899
25  1.025            31.3  ...          0.00044                 2101
26  1.066            30.2  ...          0.00039                 2370
27  1.107            29.3  ...          0.00034                 2738
28  1.148            29.1  ...          0.00028                 3371
29  1.189            28.5  ...          0.00020                 4748
30  1.230            28.6  ...          0.00000    25314996618000324

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (78,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -6.10 to 6.86 m/s
  Final RV_reference RMS: 2.79 m/s
  Success! Processed 78 CCFs with 4 differential modes
  RV range: -6.1 to 6.9 m/s
  eMJD range: 59332.690415 to 59421.804826
  Activity indicator ranges:
    ΔRV_1: RMS = 2.01 m/s
    ΔRV_2: RMS = 3.76 m/s
    ΔRV_3: RMS = 9.90 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harpsn_fiesta_rv_gauss.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harpsn_fiesta_mode1.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harpsn_fiesta_mode2.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harpsn_fiesta_mode3.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harpsn_fiesta_mode4.dat (n_obs=84)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harps_fiesta_rv_gauss.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harps_fiesta_mode1.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harps_fiesta_mode2.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harps_fiesta_mode3.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_harps_fiesta_mode4.dat (n_obs=24)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_expres_fiesta_rv_gauss.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_expres_fiesta_mode1.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_expres_fiesta_mode2.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_expres_fiesta_mode3.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_expres_fiesta_mode4.dat (n_obs=93)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_neid_fiesta_rv_gauss.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_neid_fiesta_mode1.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_neid_fiesta_mode2.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_neid_fiesta_mode3.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS4_neid_fiesta_mode4.dat (n_obs=78)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS4...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS4_FIESTA_style.png
Completed analysis for DS4

============================================================
Processing Dataset 5
============================================================

=== FIESTA Analysis for DS5 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432629.20
  Max: 897027.31
  Mean: 753735.72
  Range: 464398.10
  Deepest point: v=0.40 km/s, flux=432629.20
  Highest point: v=11.60 km/s, flux=897027.31
CCF 0 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 433009.69
  Max: 896844.48
  Mean: 753996.00
  Range: 463834.79
  Deepest point: v=0.40 km/s, flux=433009.69
  Highest point: v=11.60 km/s, flux=896844.48
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432467.20
  Max: 896922.17
  Mean: 753972.81
  Range: 464454.97
  Deepest point: v=0.40 km/s, flux=432467.20
  Highest point: v=11.60 km/s, flux=896922.17
CCF 2 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5178
    CCF variation across observations: 0.000158
    CCF center variations: 0.3010 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 84 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22261
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45394.9  ...          0.17804                    5
1   0.041         32736.3  ...          0.07232                   13
2   0.082         14144.2  ...          0.01724                   54
3   0.123          3384.9  ...          0.00394                  237
4   0.164           744.0  ...          0.00131                  709
5   0.205            39.8  ...          0.00130                  716
6   0.246           121.9  ...          0.00115                  807
7   0.287            91.1  ...          0.00107                  874
8   0.328            76.4  ...          0.00100                  935
9   0.369            71.4  ...          0.00093                  997
10  0.410            63.5  ...          0.00088                 1060
11  0.451            58.9  ...          0.00083                 1122
12  0.492            53.0  ...          0.00079                 1185
13  0.533            50.6  ...          0.00075                 1250
14  0.574            47.7  ...          0.00071                 1317
15  0.615            44.6  ...          0.00067                 1384
16  0.656            41.8  ...          0.00064                 1456
17  0.697            39.4  ...          0.00061                 1529
18  0.738            39.1  ...          0.00058                 1613
19  0.779            37.0  ...          0.00055                 1701
20  0.820            36.0  ...          0.00052                 1799
21  0.861            35.3  ...          0.00049                 1912
22  0.902            34.2  ...          0.00046                 2040
23  0.943            34.9  ...          0.00042                 2201
24  0.984            34.8  ...          0.00039                 2401
25  1.025            36.5  ...          0.00035                 2663
26  1.066            31.1  ...          0.00031                 2983
27  1.107            31.4  ...          0.00027                 3430
28  1.148            33.6  ...          0.00022                 4228
29  1.189            30.4  ...          0.00016                 5866
30  1.230            32.5  ...          0.00000    24559765075487420

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (84,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -6.73 to 5.56 m/s
  Final RV_reference RMS: 2.66 m/s
  Success! Processed 84 CCFs with 4 differential modes
  RV range: -6.7 to 5.6 m/s
  eMJD range: 59334.700184 to 59423.689751
  Activity indicator ranges:
    ΔRV_1: RMS = 3.24 m/s
    ΔRV_2: RMS = 4.82 m/s
    ΔRV_3: RMS = 11.83 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445486.48
  Max: 887339.75
  Mean: 747192.96
  Range: 441853.27
  Deepest point: v=0.80 km/s, flux=445486.48
  Highest point: v=12.00 km/s, flux=887339.75
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445610.13
  Max: 887150.61
  Mean: 747259.22
  Range: 441540.48
  Deepest point: v=0.40 km/s, flux=445610.13
  Highest point: v=12.00 km/s, flux=887150.61
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445666.98
  Max: 887462.67
  Mean: 747251.18
  Range: 441795.70
  Deepest point: v=0.80 km/s, flux=445666.98
  Highest point: v=12.00 km/s, flux=887462.67
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4986
    CCF variation across observations: 0.000253
    CCF center variations: 0.1174 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 21 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19685
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.02

In summary, the cut-off frequency is recommended to be 1.02 (k_max = 25)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40346.7  ...          0.17054                    5
1   0.041         28253.7  ...          0.06807                   14
2   0.082         11954.0  ...          0.01591                   59
3   0.123          2789.1  ...          0.00380                  245
4   0.164           625.1  ...          0.00164                  567
5   0.205            75.5  ...          0.00159                  585
6   0.246           124.8  ...          0.00144                  649
7   0.287           100.5  ...          0.00132                  706
8   0.328            88.6  ...          0.00122                  762
9   0.369            75.3  ...          0.00115                  814
10  0.410            68.0  ...          0.00108                  865
11  0.451            64.9  ...          0.00102                  917
12  0.492            60.3  ...          0.00096                  972
13  0.533            54.2  ...          0.00091                 1026
14  0.574            49.0  ...          0.00087                 1076
15  0.615            48.5  ...          0.00082                 1132
16  0.656            46.4  ...          0.00078                 1193
17  0.697            45.4  ...          0.00074                 1259
18  0.738            41.0  ...          0.00070                 1323
19  0.779            39.5  ...          0.00067                 1397
20  0.820            39.5  ...          0.00063                 1484
21  0.861            36.6  ...          0.00059                 1572
22  0.902            37.4  ...          0.00055                 1681
23  0.943            38.4  ...          0.00052                 1805
24  0.984            36.6  ...          0.00047                 1978
25  1.025            38.7  ...          0.00042                 2216
26  1.066            33.1  ...          0.00038                 2466
27  1.107            31.5  ...          0.00033                 2792
28  1.148            36.2  ...          0.00027                 3473
29  1.189            33.7  ...          0.00019                 4884
30  1.230            34.5  ...          0.00000    20167656031517144

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (21,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -3.47 to 4.01 m/s
  Final RV_reference RMS: 1.75 m/s
  Success! Processed 21 CCFs with 4 differential modes
  RV range: -3.5 to 4.0 m/s
  eMJD range: 59401.927059 to 59422.874376
  Activity indicator ranges:
    ΔRV_1: RMS = 2.68 m/s
    ΔRV_2: RMS = 3.93 m/s
    ΔRV_3: RMS = 12.29 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398418.17
  Max: 766600.73
  Mean: 650762.45
  Range: 368182.56
  Deepest point: v=0.00 km/s, flux=398418.17
  Highest point: v=12.00 km/s, flux=766600.73
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398691.87
  Max: 766554.25
  Mean: 650565.29
  Range: 367862.38
  Deepest point: v=0.00 km/s, flux=398691.87
  Highest point: v=12.00 km/s, flux=766554.25
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398741.83
  Max: 766777.55
  Mean: 650857.74
  Range: 368035.72
  Deepest point: v=0.00 km/s, flux=398741.83
  Highest point: v=12.00 km/s, flux=766777.55
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4808
    CCF variation across observations: 0.000225
    CCF center variations: 0.1345 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 100 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16698
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32418.6  ...          0.16081                    6
1   0.041         22195.1  ...          0.06660                   14
2   0.082          9666.9  ...          0.01893                   49
3   0.123          2771.3  ...          0.00477                  196
4   0.164           598.9  ...          0.00267                  350
5   0.205           176.1  ...          0.00241                  388
6   0.246           167.8  ...          0.00214                  437
7   0.287           118.1  ...          0.00199                  470
8   0.328           111.3  ...          0.00185                  505
9   0.369            98.2  ...          0.00174                  539
10  0.410            89.3  ...          0.00163                  574
11  0.451            79.5  ...          0.00154                  606
12  0.492            76.2  ...          0.00146                  641
13  0.533            70.7  ...          0.00139                  676
14  0.574            65.0  ...          0.00132                  710
15  0.615            62.9  ...          0.00125                  749
16  0.656            59.4  ...          0.00119                  788
17  0.697            56.4  ...          0.00113                  831
18  0.738            55.1  ...          0.00107                  878
19  0.779            52.4  ...          0.00101                  928
20  0.820            50.9  ...          0.00095                  984
21  0.861            48.6  ...          0.00090                 1046
22  0.902            48.4  ...          0.00084                 1120
23  0.943            46.8  ...          0.00078                 1207
24  0.984            45.5  ...          0.00072                 1309
25  1.025            46.1  ...          0.00065                 1443
26  1.066            44.5  ...          0.00058                 1619
27  1.107            44.5  ...          0.00050                 1874
28  1.148            43.6  ...          0.00041                 2296
29  1.189            43.4  ...          0.00029                 3246
30  1.230            43.8  ...          0.00000    19280003590061416

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (100,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.58 to 4.91 m/s
  Final RV_reference RMS: 2.57 m/s
  Success! Processed 100 CCFs with 4 differential modes
  RV range: -5.6 to 4.9 m/s
  eMJD range: 59336.087932 to 59421.136709
  Activity indicator ranges:
    ΔRV_1: RMS = 2.47 m/s
    ΔRV_2: RMS = 4.03 m/s
    ΔRV_3: RMS = 11.99 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419904.98
  Max: 793593.66
  Mean: 675429.50
  Range: 373688.69
  Deepest point: v=0.00 km/s, flux=419904.98
  Highest point: v=12.00 km/s, flux=793593.66
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419967.07
  Max: 793497.80
  Mean: 675223.91
  Range: 373530.74
  Deepest point: v=0.00 km/s, flux=419967.07
  Highest point: v=12.00 km/s, flux=793497.80
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 419926.39
  Max: 793464.88
  Mean: 675273.23
  Range: 373538.50
  Deepest point: v=0.00 km/s, flux=419926.39
  Highest point: v=12.00 km/s, flux=793464.88
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4709
    CCF variation across observations: 0.000124
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 75 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16079
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30424.9  ...          0.15981                    6
1   0.041         21217.7  ...          0.06313                   15
2   0.082          8803.8  ...          0.01667                   56
3   0.123          2344.6  ...          0.00383                  244
4   0.164           489.5  ...          0.00179                  522
5   0.205           106.2  ...          0.00164                  571
6   0.246           108.7  ...          0.00146                  642
7   0.287            78.9  ...          0.00135                  691
8   0.328            72.4  ...          0.00126                  743
9   0.369            63.3  ...          0.00118                  792
10  0.410            58.1  ...          0.00111                  841
11  0.451            53.2  ...          0.00105                  891
12  0.492            48.9  ...          0.00099                  940
13  0.533            46.1  ...          0.00094                  992
14  0.574            43.1  ...          0.00089                 1045
15  0.615            40.9  ...          0.00085                 1099
16  0.656            38.8  ...          0.00081                 1158
17  0.697            36.6  ...          0.00077                 1219
18  0.738            35.7  ...          0.00073                 1286
19  0.779            34.1  ...          0.00069                 1359
20  0.820            33.2  ...          0.00065                 1441
21  0.861            31.4  ...          0.00061                 1532
22  0.902            31.6  ...          0.00057                 1637
23  0.943            32.6  ...          0.00053                 1771
24  0.984            30.0  ...          0.00049                 1915
25  1.025            30.6  ...          0.00044                 2115
26  1.066            29.8  ...          0.00039                 2382
27  1.107            29.3  ...          0.00034                 2757
28  1.148            28.1  ...          0.00028                 3386
29  1.189            28.4  ...          0.00020                 4782
30  1.230            28.5  ...          0.00000    19095624964719664

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (75,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.60 to 4.38 m/s
  Final RV_reference RMS: 2.19 m/s
  Success! Processed 75 CCFs with 4 differential modes
  RV range: -4.6 to 4.4 m/s
  eMJD range: 59334.934601 to 59420.991383
  Activity indicator ranges:
    ΔRV_1: RMS = 2.22 m/s
    ΔRV_2: RMS = 3.40 m/s
    ΔRV_3: RMS = 11.24 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harpsn_fiesta_rv_gauss.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harpsn_fiesta_mode1.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harpsn_fiesta_mode2.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harpsn_fiesta_mode3.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harpsn_fiesta_mode4.dat (n_obs=84)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harps_fiesta_rv_gauss.dat (n_obs=21)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harps_fiesta_mode1.dat (n_obs=21)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harps_fiesta_mode2.dat (n_obs=21)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harps_fiesta_mode3.dat (n_obs=21)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_harps_fiesta_mode4.dat (n_obs=21)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_expres_fiesta_rv_gauss.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_expres_fiesta_mode1.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_expres_fiesta_mode2.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_expres_fiesta_mode3.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_expres_fiesta_mode4.dat (n_obs=100)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_neid_fiesta_rv_gauss.dat (n_obs=75)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_neid_fiesta_mode1.dat (n_obs=75)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_neid_fiesta_mode2.dat (n_obs=75)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_neid_fiesta_mode3.dat (n_obs=75)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS5_neid_fiesta_mode4.dat (n_obs=75)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS5...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS5_FIESTA_style.png
Completed analysis for DS5

============================================================
Processing Dataset 6
============================================================

=== FIESTA Analysis for DS6 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432795.51
  Max: 896702.48
  Mean: 753772.08
  Range: 463906.97
  Deepest point: v=0.40 km/s, flux=432795.51
  Highest point: v=11.60 km/s, flux=896702.48
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432959.99
  Max: 896450.93
  Mean: 753684.10
  Range: 463490.94
  Deepest point: v=0.40 km/s, flux=432959.99
  Highest point: v=12.00 km/s, flux=896450.93
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 433161.63
  Max: 896848.84
  Mean: 753965.95
  Range: 463687.21
  Deepest point: v=0.40 km/s, flux=433161.63
  Highest point: v=11.20 km/s, flux=896848.84
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5179
    CCF variation across observations: 0.000205
    CCF center variations: 0.2748 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 90 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22323
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45811.1  ...          0.17804                    5
1   0.041         33056.7  ...          0.07232                   13
2   0.082         14263.8  ...          0.01724                   54
3   0.123          3409.1  ...          0.00393                  237
4   0.164           753.4  ...          0.00132                  708
5   0.205            39.2  ...          0.00130                  715
6   0.246           122.6  ...          0.00116                  802
7   0.287            91.5  ...          0.00107                  870
8   0.328            79.2  ...          0.00100                  933
9   0.369            70.0  ...          0.00094                  996
10  0.410            65.3  ...          0.00088                 1058
11  0.451            60.5  ...          0.00083                 1120
12  0.492            55.2  ...          0.00079                 1184
13  0.533            51.1  ...          0.00075                 1249
14  0.574            48.2  ...          0.00071                 1317
15  0.615            45.0  ...          0.00067                 1385
16  0.656            43.0  ...          0.00064                 1458
17  0.697            40.9  ...          0.00061                 1536
18  0.738            39.4  ...          0.00058                 1619
19  0.779            37.9  ...          0.00054                 1710
20  0.820            36.6  ...          0.00051                 1812
21  0.861            35.7  ...          0.00048                 1926
22  0.902            34.6  ...          0.00045                 2058
23  0.943            35.4  ...          0.00042                 2221
24  0.984            33.5  ...          0.00038                 2421
25  1.025            34.6  ...          0.00035                 2677
26  1.066            30.8  ...          0.00031                 3006
27  1.107            31.6  ...          0.00027                 3457
28  1.148            32.9  ...          0.00022                 4253
29  1.189            31.0  ...          0.00016                 5955
30  1.230            32.1  ...          0.00000    15665840441686426

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (90,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -8.33 to 7.82 m/s
  Final RV_reference RMS: 2.96 m/s
  Success! Processed 90 CCFs with 4 differential modes
  RV range: -8.3 to 7.8 m/s
  eMJD range: 59333.415568 to 59420.314375
  Activity indicator ranges:
    ΔRV_1: RMS = 3.13 m/s
    ΔRV_2: RMS = 4.97 m/s
    ΔRV_3: RMS = 10.78 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446001.45
  Max: 887824.46
  Mean: 747332.26
  Range: 441823.01
  Deepest point: v=0.80 km/s, flux=446001.45
  Highest point: v=12.00 km/s, flux=887824.46
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446093.49
  Max: 887631.37
  Mean: 747319.90
  Range: 441537.88
  Deepest point: v=0.80 km/s, flux=446093.49
  Highest point: v=11.60 km/s, flux=887631.37
CCF 1 AFTER INVERSION:
  Original range: [0.503, 1.000]
  Inverted range: [0.000, 0.497]
  Line depth (inverted): 0.497
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445966.73
  Max: 887595.28
  Mean: 747278.89
  Range: 441628.55
  Deepest point: v=0.80 km/s, flux=445966.73
  Highest point: v=12.00 km/s, flux=887595.28
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4982
    CCF variation across observations: 0.000151
    CCF center variations: 0.1826 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 27 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19849
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.02

In summary, the cut-off frequency is recommended to be 1.02 (k_max = 25)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40376.5  ...          0.17055                    5
1   0.041         28270.3  ...          0.06806                   14
2   0.082         11981.3  ...          0.01591                   59
3   0.123          2794.1  ...          0.00383                  243
4   0.164           632.0  ...          0.00163                  573
5   0.205            80.6  ...          0.00157                  594
6   0.246           125.9  ...          0.00141                  660
7   0.287            99.8  ...          0.00130                  716
8   0.328            87.9  ...          0.00121                  772
9   0.369            79.5  ...          0.00113                  825
10  0.410            68.3  ...          0.00106                  876
11  0.451            62.6  ...          0.00101                  925
12  0.492            60.7  ...          0.00095                  977
13  0.533            58.5  ...          0.00090                 1036
14  0.574            50.7  ...          0.00085                 1090
15  0.615            49.2  ...          0.00081                 1147
16  0.656            46.1  ...          0.00077                 1205
17  0.697            43.0  ...          0.00074                 1266
18  0.738            42.4  ...          0.00070                 1336
19  0.779            40.0  ...          0.00066                 1408
20  0.820            39.6  ...          0.00062                 1491
21  0.861            37.0  ...          0.00059                 1578
22  0.902            38.7  ...          0.00055                 1689
23  0.943            32.4  ...          0.00052                 1789
24  0.984            46.3  ...          0.00047                 2003
25  1.025            37.1  ...          0.00042                 2220
26  1.066            33.3  ...          0.00038                 2468
27  1.107            31.4  ...          0.00033                 2788
28  1.148            36.4  ...          0.00027                 3469
29  1.189            34.3  ...          0.00019                 4897
30  1.230            34.5  ...          0.00000    20560830265884180

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (27,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.30 to 3.50 m/s
  Final RV_reference RMS: 2.36 m/s
  Success! Processed 27 CCFs with 4 differential modes
  RV range: -5.3 to 3.5 m/s
  eMJD range: 59396.579107 to 59414.563371
  Activity indicator ranges:
    ΔRV_1: RMS = 2.13 m/s
    ΔRV_2: RMS = 4.44 m/s
    ΔRV_3: RMS = 17.78 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398421.57
  Max: 766601.69
  Mean: 650763.92
  Range: 368180.11
  Deepest point: v=0.00 km/s, flux=398421.57
  Highest point: v=12.00 km/s, flux=766601.69
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398661.59
  Max: 766425.10
  Mean: 650749.94
  Range: 367763.51
  Deepest point: v=0.00 km/s, flux=398661.59
  Highest point: v=12.00 km/s, flux=766425.10
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398695.82
  Max: 766556.09
  Mean: 650568.31
  Range: 367860.27
  Deepest point: v=0.00 km/s, flux=398695.82
  Highest point: v=12.00 km/s, flux=766556.09
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4807
    CCF variation across observations: 0.000247
    CCF center variations: 0.1628 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 111 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16599
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32371.6  ...          0.16087                    6
1   0.041         22182.9  ...          0.06665                   14
2   0.082          9662.0  ...          0.01895                   49
3   0.123          2770.2  ...          0.00480                  195
4   0.164           601.8  ...          0.00267                  351
5   0.205           173.0  ...          0.00241                  389
6   0.246           168.3  ...          0.00214                  438
7   0.287           118.3  ...          0.00199                  471
8   0.328           109.3  ...          0.00185                  506
9   0.369            96.4  ...          0.00174                  539
10  0.410            90.6  ...          0.00163                  574
11  0.451            80.5  ...          0.00154                  607
12  0.492            75.9  ...          0.00146                  642
13  0.533            69.7  ...          0.00138                  676
14  0.574            64.9  ...          0.00132                  711
15  0.615            63.1  ...          0.00125                  749
16  0.656            59.1  ...          0.00119                  789
17  0.697            56.9  ...          0.00112                  833
18  0.738            54.1  ...          0.00107                  878
19  0.779            52.2  ...          0.00101                  928
20  0.820            51.2  ...          0.00095                  985
21  0.861            48.4  ...          0.00090                 1045
22  0.902            48.2  ...          0.00084                 1117
23  0.943            46.9  ...          0.00078                 1205
24  0.984            44.4  ...          0.00072                 1303
25  1.025            46.3  ...          0.00065                 1435
26  1.066            44.8  ...          0.00058                 1610
27  1.107            44.4  ...          0.00050                 1868
28  1.148            44.2  ...          0.00041                 2290
29  1.189            43.7  ...          0.00029                 3224
30  1.230            43.7  ...          0.00000    21798099886725900

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (111,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.88 to 4.66 m/s
  Final RV_reference RMS: 2.34 m/s
  Success! Processed 111 CCFs with 4 differential modes
  RV range: -4.9 to 4.7 m/s
  eMJD range: 59336.758799 to 59420.753027
  Activity indicator ranges:
    ΔRV_1: RMS = 1.96 m/s
    ΔRV_2: RMS = 3.53 m/s
    ΔRV_3: RMS = 12.34 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420221.09
  Max: 793575.59
  Mean: 675404.58
  Range: 373354.50
  Deepest point: v=0.00 km/s, flux=420221.09
  Highest point: v=12.00 km/s, flux=793575.59
CCF 0 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420453.54
  Max: 793694.39
  Mean: 675581.63
  Range: 373240.85
  Deepest point: v=0.00 km/s, flux=420453.54
  Highest point: v=12.00 km/s, flux=793694.39
CCF 1 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420294.96
  Max: 793606.27
  Mean: 675467.27
  Range: 373311.31
  Deepest point: v=0.00 km/s, flux=420294.96
  Highest point: v=12.00 km/s, flux=793606.27
CCF 2 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4708
    CCF variation across observations: 0.000153
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 93 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 15958
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30303.7  ...          0.15980                    6
1   0.041         21131.7  ...          0.06312                   15
2   0.082          8761.5  ...          0.01668                   56
3   0.123          2332.9  ...          0.00384                  244
4   0.164           489.3  ...          0.00179                  521
5   0.205           105.4  ...          0.00164                  571
6   0.246           106.7  ...          0.00146                  639
7   0.287            77.6  ...          0.00136                  688
8   0.328            72.1  ...          0.00126                  739
9   0.369            63.0  ...          0.00119                  787
10  0.410            57.9  ...          0.00112                  837
11  0.451            53.1  ...          0.00105                  886
12  0.492            48.7  ...          0.00100                  935
13  0.533            45.7  ...          0.00095                  986
14  0.574            43.5  ...          0.00090                 1040
15  0.615            40.4  ...          0.00085                 1095
16  0.656            39.1  ...          0.00081                 1154
17  0.697            36.5  ...          0.00077                 1215
18  0.738            35.5  ...          0.00073                 1283
19  0.779            33.8  ...          0.00069                 1354
20  0.820            33.0  ...          0.00065                 1437
21  0.861            32.3  ...          0.00061                 1531
22  0.902            30.5  ...          0.00057                 1633
23  0.943            31.9  ...          0.00053                 1763
24  0.984            28.4  ...          0.00049                 1902
25  1.025            31.2  ...          0.00044                 2103
26  1.066            31.0  ...          0.00039                 2378
27  1.107            27.8  ...          0.00034                 2732
28  1.148            29.1  ...          0.00028                 3373
29  1.189            28.6  ...          0.00020                 4786
30  1.230            28.2  ...          0.00000    24431800796913264

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (93,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -5.66 to 4.73 m/s
  Final RV_reference RMS: 2.08 m/s
  Success! Processed 93 CCFs with 4 differential modes
  RV range: -5.7 to 4.7 m/s
  eMJD range: 59336.743932 to 59420.656469
  Activity indicator ranges:
    ΔRV_1: RMS = 1.89 m/s
    ΔRV_2: RMS = 2.98 m/s
    ΔRV_3: RMS = 10.09 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harpsn_fiesta_rv_gauss.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harpsn_fiesta_mode1.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harpsn_fiesta_mode2.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harpsn_fiesta_mode3.dat (n_obs=90)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harpsn_fiesta_mode4.dat (n_obs=90)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harps_fiesta_rv_gauss.dat (n_obs=27)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harps_fiesta_mode1.dat (n_obs=27)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harps_fiesta_mode2.dat (n_obs=27)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harps_fiesta_mode3.dat (n_obs=27)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_harps_fiesta_mode4.dat (n_obs=27)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_expres_fiesta_rv_gauss.dat (n_obs=111)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_expres_fiesta_mode1.dat (n_obs=111)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_expres_fiesta_mode2.dat (n_obs=111)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_expres_fiesta_mode3.dat (n_obs=111)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_expres_fiesta_mode4.dat (n_obs=111)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_neid_fiesta_rv_gauss.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_neid_fiesta_mode1.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_neid_fiesta_mode2.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_neid_fiesta_mode3.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS6_neid_fiesta_mode4.dat (n_obs=93)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS6...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS6_FIESTA_style.png
Completed analysis for DS6

============================================================
Processing Dataset 7
============================================================

=== FIESTA Analysis for DS7 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432347.37
  Max: 896469.80
  Mean: 753647.40
  Range: 464122.43
  Deepest point: v=0.40 km/s, flux=432347.37
  Highest point: v=11.60 km/s, flux=896469.80
CCF 0 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432828.76
  Max: 896458.74
  Mean: 753826.22
  Range: 463629.98
  Deepest point: v=0.40 km/s, flux=432828.76
  Highest point: v=11.20 km/s, flux=896458.74
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432832.06
  Max: 896827.75
  Mean: 753815.95
  Range: 463995.69
  Deepest point: v=0.40 km/s, flux=432832.06
  Highest point: v=11.60 km/s, flux=896827.75
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5177
    CCF variation across observations: 0.000157
    CCF center variations: 0.2535 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 78 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22391
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45720.7  ...          0.17803                    5
1   0.041         32958.4  ...          0.07232                   13
2   0.082         14211.9  ...          0.01723                   54
3   0.123          3392.6  ...          0.00393                  237
4   0.164           750.5  ...          0.00131                  712
5   0.205            40.0  ...          0.00130                  719
6   0.246           121.0  ...          0.00115                  807
7   0.287            89.9  ...          0.00106                  875
8   0.328            79.0  ...          0.00099                  937
9   0.369            71.9  ...          0.00093                 1000
10  0.410            62.4  ...          0.00088                 1060
11  0.451            60.6  ...          0.00083                 1124
12  0.492            55.1  ...          0.00078                 1189
13  0.533            52.3  ...          0.00074                 1259
14  0.574            48.4  ...          0.00070                 1326
15  0.615            44.9  ...          0.00067                 1395
16  0.656            43.3  ...          0.00063                 1471
17  0.697            41.0  ...          0.00060                 1548
18  0.738            38.5  ...          0.00057                 1631
19  0.779            38.0  ...          0.00054                 1725
20  0.820            36.2  ...          0.00051                 1827
21  0.861            35.4  ...          0.00048                 1943
22  0.902            34.4  ...          0.00045                 2074
23  0.943            34.4  ...          0.00042                 2236
24  0.984            33.4  ...          0.00038                 2430
25  1.025            34.1  ...          0.00035                 2683
26  1.066            31.4  ...          0.00031                 3013
27  1.107            32.2  ...          0.00027                 3479
28  1.148            32.8  ...          0.00022                 4267
29  1.189            31.3  ...          0.00015                 6060
30  1.230            32.0  ...          0.00000    16993783594619778

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (78,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.95 to 4.66 m/s
  Final RV_reference RMS: 2.35 m/s
  Success! Processed 78 CCFs with 4 differential modes
  RV range: -4.9 to 4.7 m/s
  eMJD range: 59333.584825 to 59416.600384
  Activity indicator ranges:
    ΔRV_1: RMS = 2.25 m/s
    ΔRV_2: RMS = 3.51 m/s
    ΔRV_3: RMS = 13.85 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446195.41
  Max: 887500.19
  Mean: 747497.45
  Range: 441304.78
  Deepest point: v=0.80 km/s, flux=446195.41
  Highest point: v=11.60 km/s, flux=887500.19
CCF 0 AFTER INVERSION:
  Original range: [0.503, 1.000]
  Inverted range: [0.000, 0.497]
  Line depth (inverted): 0.497
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446166.57
  Max: 887644.63
  Mean: 747441.34
  Range: 441478.07
  Deepest point: v=0.80 km/s, flux=446166.57
  Highest point: v=11.60 km/s, flux=887644.63
CCF 1 AFTER INVERSION:
  Original range: [0.503, 1.000]
  Inverted range: [0.000, 0.497]
  Line depth (inverted): 0.497
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 446290.52
  Max: 887516.83
  Mean: 747428.57
  Range: 441226.31
  Deepest point: v=0.80 km/s, flux=446290.52
  Highest point: v=11.60 km/s, flux=887516.83
CCF 2 AFTER INVERSION:
  Original range: [0.503, 1.000]
  Inverted range: [0.000, 0.497]
  Line depth (inverted): 0.497
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4983
    CCF variation across observations: 0.000231
    CCF center variations: 0.1886 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 24 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 20130
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40866.4  ...          0.17054                    5
1   0.041         28578.3  ...          0.06807                   14
2   0.082         12102.2  ...          0.01590                   59
3   0.123          2832.5  ...          0.00381                  245
4   0.164           631.2  ...          0.00162                  574
5   0.205            75.4  ...          0.00157                  593
6   0.246           125.2  ...          0.00141                  660
7   0.287            97.8  ...          0.00131                  712
8   0.328            89.7  ...          0.00122                  767
9   0.369            78.8  ...          0.00113                  821
10  0.410            69.2  ...          0.00107                  870
11  0.451            62.4  ...          0.00101                  921
12  0.492            60.6  ...          0.00096                  974
13  0.533            59.4  ...          0.00090                 1034
14  0.574            52.0  ...          0.00086                 1090
15  0.615            48.8  ...          0.00081                 1147
16  0.656            46.7  ...          0.00077                 1208
17  0.697            44.3  ...          0.00073                 1273
18  0.738            42.1  ...          0.00069                 1342
19  0.779            39.8  ...          0.00066                 1412
20  0.820            40.6  ...          0.00062                 1500
21  0.861            36.1  ...          0.00059                 1584
22  0.902            38.6  ...          0.00055                 1694
23  0.943            31.5  ...          0.00052                 1786
24  0.984            46.0  ...          0.00046                 2018
25  1.025            34.8  ...          0.00042                 2226
26  1.066            33.0  ...          0.00038                 2472
27  1.107            32.3  ...          0.00033                 2799
28  1.148            36.9  ...          0.00027                 3490
29  1.189            34.5  ...          0.00019                 4942
30  1.230            34.5  ...          0.00000    20180830843059392

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (24,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -3.17 to 2.95 m/s
  Final RV_reference RMS: 1.84 m/s
  Success! Processed 24 CCFs with 4 differential modes
  RV range: -3.2 to 2.9 m/s
  eMJD range: 59395.820428 to 59411.783730
  Activity indicator ranges:
    ΔRV_1: RMS = 2.01 m/s
    ΔRV_2: RMS = 4.96 m/s
    ΔRV_3: RMS = 15.88 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398821.87
  Max: 766368.54
  Mean: 650888.56
  Range: 367546.67
  Deepest point: v=0.00 km/s, flux=398821.87
  Highest point: v=12.00 km/s, flux=766368.54
CCF 0 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398593.72
  Max: 766534.68
  Mean: 650854.65
  Range: 367940.96
  Deepest point: v=0.00 km/s, flux=398593.72
  Highest point: v=12.00 km/s, flux=766534.68
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398681.05
  Max: 766519.60
  Mean: 650715.46
  Range: 367838.56
  Deepest point: v=0.00 km/s, flux=398681.05
  Highest point: v=12.00 km/s, flux=766519.60
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4806
    CCF variation across observations: 0.000252
    CCF center variations: 0.1671 km/s
    CCF center range: 11.2000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 104 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16586
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32254.1  ...          0.16084                    6
1   0.041         22089.6  ...          0.06663                   14
2   0.082          9640.1  ...          0.01895                   49
3   0.123          2763.9  ...          0.00478                  196
4   0.164           597.9  ...          0.00267                  350
5   0.205           171.8  ...          0.00242                  388
6   0.246           168.2  ...          0.00214                  437
7   0.287           118.3  ...          0.00199                  470
8   0.328           110.5  ...          0.00185                  506
9   0.369            96.3  ...          0.00174                  539
10  0.410            88.1  ...          0.00164                  572
11  0.451            80.8  ...          0.00155                  605
12  0.492            77.9  ...          0.00146                  642
13  0.533            70.6  ...          0.00138                  676
14  0.574            65.0  ...          0.00132                  712
15  0.615            62.5  ...          0.00125                  750
16  0.656            59.0  ...          0.00119                  788
17  0.697            58.3  ...          0.00112                  834
18  0.738            54.6  ...          0.00106                  881
19  0.779            52.3  ...          0.00101                  932
20  0.820            49.7  ...          0.00095                  986
21  0.861            47.7  ...          0.00089                 1048
22  0.902            47.5  ...          0.00084                 1120
23  0.943            46.3  ...          0.00078                 1206
24  0.984            45.3  ...          0.00072                 1307
25  1.025            46.0  ...          0.00065                 1440
26  1.066            45.0  ...          0.00058                 1623
27  1.107            43.7  ...          0.00050                 1877
28  1.148            43.1  ...          0.00041                 2296
29  1.189            43.4  ...          0.00029                 3232
30  1.230            43.6  ...          0.00000    24647206691240976

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (104,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.39 to 4.37 m/s
  Final RV_reference RMS: 1.85 m/s
  Success! Processed 104 CCFs with 4 differential modes
  RV range: -4.4 to 4.4 m/s
  eMJD range: 59335.858004 to 59418.799316
  Activity indicator ranges:
    ΔRV_1: RMS = 2.25 m/s
    ΔRV_2: RMS = 4.40 m/s
    ΔRV_3: RMS = 10.68 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420044.83
  Max: 793490.00
  Mean: 675335.09
  Range: 373445.17
  Deepest point: v=0.00 km/s, flux=420044.83
  Highest point: v=12.00 km/s, flux=793490.00
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420294.47
  Max: 793584.44
  Mean: 675570.77
  Range: 373289.97
  Deepest point: v=0.00 km/s, flux=420294.47
  Highest point: v=12.00 km/s, flux=793584.44
CCF 1 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420144.81
  Max: 793512.38
  Mean: 675324.45
  Range: 373367.57
  Deepest point: v=0.00 km/s, flux=420144.81
  Highest point: v=12.00 km/s, flux=793512.38
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4709
    CCF variation across observations: 0.000154
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 84 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 15934
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30209.0  ...          0.15980                    6
1   0.041         21062.0  ...          0.06311                   15
2   0.082          8733.2  ...          0.01667                   56
3   0.123          2326.3  ...          0.00384                  243
4   0.164           487.6  ...          0.00180                  521
5   0.205           105.0  ...          0.00164                  570
6   0.246           106.6  ...          0.00146                  639
7   0.287            78.2  ...          0.00136                  687
8   0.328            72.8  ...          0.00126                  739
9   0.369            63.2  ...          0.00119                  788
10  0.410            57.2  ...          0.00112                  837
11  0.451            53.6  ...          0.00105                  887
12  0.492            48.7  ...          0.00100                  935
13  0.533            45.5  ...          0.00095                  986
14  0.574            43.4  ...          0.00090                 1040
15  0.615            40.3  ...          0.00085                 1094
16  0.656            38.6  ...          0.00081                 1153
17  0.697            37.3  ...          0.00077                 1216
18  0.738            35.2  ...          0.00073                 1282
19  0.779            34.0  ...          0.00069                 1355
20  0.820            32.7  ...          0.00065                 1437
21  0.861            31.5  ...          0.00061                 1526
22  0.902            32.2  ...          0.00057                 1636
23  0.943            31.6  ...          0.00053                 1766
24  0.984            29.9  ...          0.00049                 1924
25  1.025            28.7  ...          0.00044                 2114
26  1.066            27.3  ...          0.00040                 2362
27  1.107            30.4  ...          0.00034                 2763
28  1.148            26.8  ...          0.00028                 3361
29  1.189            28.3  ...          0.00020                 4730
30  1.230            28.6  ...          0.00000    20299632617735724

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (84,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.72 to 5.59 m/s
  Final RV_reference RMS: 2.02 m/s
  Success! Processed 84 CCFs with 4 differential modes
  RV range: -4.7 to 5.6 m/s
  eMJD range: 59334.835761 to 59418.868144
  Activity indicator ranges:
    ΔRV_1: RMS = 2.32 m/s
    ΔRV_2: RMS = 3.19 m/s
    ΔRV_3: RMS = 10.72 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harpsn_fiesta_rv_gauss.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harpsn_fiesta_mode1.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harpsn_fiesta_mode2.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harpsn_fiesta_mode3.dat (n_obs=78)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harpsn_fiesta_mode4.dat (n_obs=78)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harps_fiesta_rv_gauss.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harps_fiesta_mode1.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harps_fiesta_mode2.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harps_fiesta_mode3.dat (n_obs=24)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_harps_fiesta_mode4.dat (n_obs=24)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_expres_fiesta_rv_gauss.dat (n_obs=104)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_expres_fiesta_mode1.dat (n_obs=104)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_expres_fiesta_mode2.dat (n_obs=104)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_expres_fiesta_mode3.dat (n_obs=104)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_expres_fiesta_mode4.dat (n_obs=104)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_neid_fiesta_rv_gauss.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_neid_fiesta_mode1.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_neid_fiesta_mode2.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_neid_fiesta_mode3.dat (n_obs=84)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS7_neid_fiesta_mode4.dat (n_obs=84)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS7...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS7_FIESTA_style.png
Completed analysis for DS7

============================================================
Processing Dataset 8
============================================================

=== FIESTA Analysis for DS8 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432888.37
  Max: 896725.17
  Mean: 753847.13
  Range: 463836.80
  Deepest point: v=0.40 km/s, flux=432888.37
  Highest point: v=10.80 km/s, flux=896725.17
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432839.87
  Max: 897274.44
  Mean: 753813.25
  Range: 464434.58
  Deepest point: v=0.40 km/s, flux=432839.87
  Highest point: v=11.60 km/s, flux=897274.44
CCF 1 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432475.52
  Max: 896563.51
  Mean: 753589.97
  Range: 464087.99
  Deepest point: v=0.40 km/s, flux=432475.52
  Highest point: v=11.60 km/s, flux=896563.51
CCF 2 AFTER INVERSION:
  Original range: [0.482, 1.000]
  Inverted range: [0.000, 0.518]
  Line depth (inverted): 0.518
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5179
    CCF variation across observations: 0.000213
    CCF center variations: 0.2890 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 87 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22489
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45816.9  ...          0.17805                    5
1   0.041         33109.2  ...          0.07232                   13
2   0.082         14284.7  ...          0.01724                   54
3   0.123          3409.3  ...          0.00393                  237
4   0.164           753.1  ...          0.00131                  713
5   0.205            40.4  ...          0.00129                  721
6   0.246           121.0  ...          0.00115                  811
7   0.287            90.1  ...          0.00106                  878
8   0.328            78.1  ...          0.00099                  943
9   0.369            69.7  ...          0.00093                 1004
10  0.410            64.1  ...          0.00087                 1067
11  0.451            59.2  ...          0.00082                 1131
12  0.492            54.4  ...          0.00078                 1194
13  0.533            50.1  ...          0.00074                 1259
14  0.574            48.1  ...          0.00070                 1327
15  0.615            44.2  ...          0.00067                 1394
16  0.656            43.5  ...          0.00063                 1470
17  0.697            40.8  ...          0.00060                 1549
18  0.738            39.0  ...          0.00057                 1633
19  0.779            38.0  ...          0.00054                 1726
20  0.820            36.2  ...          0.00051                 1826
21  0.861            35.6  ...          0.00048                 1940
22  0.902            33.7  ...          0.00045                 2069
23  0.943            34.8  ...          0.00042                 2230
24  0.984            34.4  ...          0.00038                 2432
25  1.025            34.9  ...          0.00035                 2694
26  1.066            31.5  ...          0.00031                 3020
27  1.107            31.3  ...          0.00027                 3475
28  1.148            33.3  ...          0.00022                 4282
29  1.189            31.1  ...          0.00016                 5954
30  1.230            32.3  ...          0.00000    17995199257526262

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (87,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -7.62 to 9.23 m/s
  Final RV_reference RMS: 4.03 m/s
  Success! Processed 87 CCFs with 4 differential modes
  RV range: -7.6 to 9.2 m/s
  eMJD range: 59332.340853 to 59422.503487
  Activity indicator ranges:
    ΔRV_1: RMS = 2.87 m/s
    ΔRV_2: RMS = 4.22 m/s
    ΔRV_3: RMS = 13.28 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445893.92
  Max: 887683.95
  Mean: 747316.68
  Range: 441790.03
  Deepest point: v=0.40 km/s, flux=445893.92
  Highest point: v=11.60 km/s, flux=887683.95
CCF 0 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445899.90
  Max: 887519.10
  Mean: 747214.83
  Range: 441619.20
  Deepest point: v=0.40 km/s, flux=445899.90
  Highest point: v=11.60 km/s, flux=887519.10
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445771.91
  Max: 887719.12
  Mean: 747425.23
  Range: 441947.21
  Deepest point: v=0.40 km/s, flux=445771.91
  Highest point: v=11.60 km/s, flux=887719.12
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4982
    CCF variation across observations: 0.000237
    CCF center variations: 0.1769 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 30 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19942
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.02

In summary, the cut-off frequency is recommended to be 1.02 (k_max = 25)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         40401.3  ...          0.17051                    5
1   0.041         28312.9  ...          0.06804                   14
2   0.082         12004.3  ...          0.01591                   59
3   0.123          2798.2  ...          0.00382                  244
4   0.164           626.4  ...          0.00166                  562
5   0.205            77.5  ...          0.00160                  582
6   0.246           128.0  ...          0.00144                  648
7   0.287           104.2  ...          0.00132                  707
8   0.328            85.8  ...          0.00123                  759
9   0.369            80.0  ...          0.00115                  812
10  0.410            67.3  ...          0.00109                  858
11  0.451            63.5  ...          0.00103                  908
12  0.492            59.6  ...          0.00097                  960
13  0.533            58.4  ...          0.00092                 1015
14  0.574            54.3  ...          0.00087                 1073
15  0.615            49.5  ...          0.00082                 1134
16  0.656            46.2  ...          0.00078                 1193
17  0.697            44.7  ...          0.00074                 1256
18  0.738            42.4  ...          0.00070                 1322
19  0.779            40.7  ...          0.00067                 1395
20  0.820            39.2  ...          0.00063                 1477
21  0.861            36.3  ...          0.00060                 1559
22  0.902            40.1  ...          0.00056                 1673
23  0.943            31.8  ...          0.00053                 1773
24  0.984            45.6  ...          0.00047                 1987
25  1.025            36.7  ...          0.00042                 2198
26  1.066            33.2  ...          0.00038                 2442
27  1.107            31.9  ...          0.00034                 2764
28  1.148            36.6  ...          0.00027                 3441
29  1.189            34.0  ...          0.00019                 4852
30  1.230            35.2  ...          0.00000    19295509440024928

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (30,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.28 to 4.69 m/s
  Final RV_reference RMS: 1.89 m/s
  Success! Processed 30 CCFs with 4 differential modes
  RV range: -4.3 to 4.7 m/s
  eMJD range: 59396.554028 to 59422.586241
  Activity indicator ranges:
    ΔRV_1: RMS = 2.17 m/s
    ΔRV_2: RMS = 3.50 m/s
    ΔRV_3: RMS = 13.00 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398325.32
  Max: 766873.29
  Mean: 650701.16
  Range: 368547.97
  Deepest point: v=0.00 km/s, flux=398325.32
  Highest point: v=11.60 km/s, flux=766873.29
CCF 0 AFTER INVERSION:
  Original range: [0.519, 1.000]
  Inverted range: [0.000, 0.481]
  Line depth (inverted): 0.481
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398497.73
  Max: 766652.39
  Mean: 650865.67
  Range: 368154.66
  Deepest point: v=0.00 km/s, flux=398497.73
  Highest point: v=11.60 km/s, flux=766652.39
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398549.72
  Max: 766720.56
  Mean: 650727.14
  Range: 368170.84
  Deepest point: v=0.00 km/s, flux=398549.72
  Highest point: v=12.00 km/s, flux=766720.56
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4808
    CCF variation across observations: 0.000208
    CCF center variations: 0.1521 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 114 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16594
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32466.0  ...          0.16082                    6
1   0.041         22212.5  ...          0.06658                   14
2   0.082          9683.7  ...          0.01894                   49
3   0.123          2776.8  ...          0.00478                  196
4   0.164           597.6  ...          0.00268                  349
5   0.205           174.5  ...          0.00242                  388
6   0.246           167.1  ...          0.00215                  436
7   0.287           118.7  ...          0.00200                  469
8   0.328           111.0  ...          0.00186                  504
9   0.369            97.9  ...          0.00174                  538
10  0.410            89.6  ...          0.00164                  572
11  0.451            81.0  ...          0.00155                  605
12  0.492            75.6  ...          0.00146                  639
13  0.533            71.6  ...          0.00139                  674
14  0.574            65.6  ...          0.00132                  710
15  0.615            62.7  ...          0.00125                  748
16  0.656            59.6  ...          0.00119                  789
17  0.697            56.3  ...          0.00113                  831
18  0.738            54.9  ...          0.00107                  878
19  0.779            52.5  ...          0.00101                  928
20  0.820            52.4  ...          0.00095                  988
21  0.861            48.4  ...          0.00089                 1049
22  0.902            47.9  ...          0.00083                 1123
23  0.943            46.5  ...          0.00077                 1209
24  0.984            43.8  ...          0.00072                 1307
25  1.025            45.5  ...          0.00065                 1441
26  1.066            44.4  ...          0.00058                 1614
27  1.107            44.8  ...          0.00050                 1875
28  1.148            43.4  ...          0.00041                 2293
29  1.189            43.5  ...          0.00029                 3245
30  1.230            43.7  ...          0.00000    18872481784931688

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (114,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -7.06 to 11.29 m/s
  Final RV_reference RMS: 4.34 m/s
  Success! Processed 114 CCFs with 4 differential modes
  RV range: -7.1 to 11.3 m/s
  eMJD range: 59338.753053 to 59422.796142
  Activity indicator ranges:
    ΔRV_1: RMS = 2.27 m/s
    ΔRV_2: RMS = 4.13 m/s
    ΔRV_3: RMS = 12.53 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420059.83
  Max: 793652.03
  Mean: 675472.71
  Range: 373592.19
  Deepest point: v=0.00 km/s, flux=420059.83
  Highest point: v=12.00 km/s, flux=793652.03
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420043.68
  Max: 793593.07
  Mean: 675179.07
  Range: 373549.39
  Deepest point: v=0.00 km/s, flux=420043.68
  Highest point: v=12.00 km/s, flux=793593.07
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420240.04
  Max: 793650.58
  Mean: 675350.85
  Range: 373410.54
  Deepest point: v=0.00 km/s, flux=420240.04
  Highest point: v=12.00 km/s, flux=793650.58
CCF 2 AFTER INVERSION:
  Original range: [0.530, 1.000]
  Inverted range: [0.000, 0.470]
  Line depth (inverted): 0.470
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4710
    CCF variation across observations: 0.000175
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 93 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16031
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30401.4  ...          0.15979                    6
1   0.041         21190.5  ...          0.06309                   15
2   0.082          8776.9  ...          0.01666                   56
3   0.123          2337.5  ...          0.00382                  244
4   0.164           488.6  ...          0.00180                  520
5   0.205           107.5  ...          0.00164                  571
6   0.246           107.2  ...          0.00146                  640
7   0.287            79.0  ...          0.00136                  689
8   0.328            73.2  ...          0.00126                  741
9   0.369            64.0  ...          0.00118                  790
10  0.410            58.0  ...          0.00111                  840
11  0.451            53.9  ...          0.00105                  889
12  0.492            48.4  ...          0.00100                  937
13  0.533            45.7  ...          0.00095                  988
14  0.574            43.5  ...          0.00090                 1041
15  0.615            40.7  ...          0.00085                 1096
16  0.656            39.5  ...          0.00081                 1157
17  0.697            37.0  ...          0.00077                 1218
18  0.738            35.3  ...          0.00073                 1285
19  0.779            34.4  ...          0.00069                 1358
20  0.820            33.0  ...          0.00065                 1441
21  0.861            31.4  ...          0.00061                 1530
22  0.902            32.1  ...          0.00057                 1638
23  0.943            32.8  ...          0.00053                 1772
24  0.984            30.4  ...          0.00049                 1921
25  1.025            29.4  ...          0.00044                 2120
26  1.066            28.2  ...          0.00039                 2376
27  1.107            29.9  ...          0.00034                 2771
28  1.148            27.8  ...          0.00028                 3388
29  1.189            28.0  ...          0.00020                 4745
30  1.230            28.7  ...          0.00000    17498158924509774

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (93,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -6.61 to 10.77 m/s
  Final RV_reference RMS: 3.58 m/s
  Success! Processed 93 CCFs with 4 differential modes
  RV range: -6.6 to 10.8 m/s
  eMJD range: 59332.673420 to 59422.639473
  Activity indicator ranges:
    ΔRV_1: RMS = 1.97 m/s
    ΔRV_2: RMS = 3.29 m/s
    ΔRV_3: RMS = 9.93 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harpsn_fiesta_rv_gauss.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harpsn_fiesta_mode1.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harpsn_fiesta_mode2.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harpsn_fiesta_mode3.dat (n_obs=87)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harpsn_fiesta_mode4.dat (n_obs=87)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harps_fiesta_rv_gauss.dat (n_obs=30)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harps_fiesta_mode1.dat (n_obs=30)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harps_fiesta_mode2.dat (n_obs=30)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harps_fiesta_mode3.dat (n_obs=30)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_harps_fiesta_mode4.dat (n_obs=30)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_expres_fiesta_rv_gauss.dat (n_obs=114)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_expres_fiesta_mode1.dat (n_obs=114)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_expres_fiesta_mode2.dat (n_obs=114)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_expres_fiesta_mode3.dat (n_obs=114)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_expres_fiesta_mode4.dat (n_obs=114)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_neid_fiesta_rv_gauss.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_neid_fiesta_mode1.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_neid_fiesta_mode2.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_neid_fiesta_mode3.dat (n_obs=93)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS8_neid_fiesta_mode4.dat (n_obs=93)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS8...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS8_FIESTA_style.png
Completed analysis for DS8

============================================================
Processing Dataset 9
============================================================

=== FIESTA Analysis for DS9 ===

Processing HARPSN...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432843.62
  Max: 896827.13
  Mean: 753813.59
  Range: 463983.51
  Deepest point: v=0.40 km/s, flux=432843.62
  Highest point: v=11.60 km/s, flux=896827.13
CCF 0 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432831.42
  Max: 897029.24
  Mean: 753757.74
  Range: 464197.83
  Deepest point: v=0.40 km/s, flux=432831.42
  Highest point: v=11.20 km/s, flux=897029.24
CCF 1 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 432991.41
  Max: 896628.89
  Mean: 753874.25
  Range: 463637.48
  Deepest point: v=0.40 km/s, flux=432991.41
  Highest point: v=11.20 km/s, flux=896628.89
CCF 2 AFTER INVERSION:
  Original range: [0.483, 1.000]
  Inverted range: [0.000, 0.517]
  Line depth (inverted): 0.517
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.5177
    CCF variation across observations: 0.000151
    CCF center variations: 0.2783 km/s
    CCF center range: 10.8000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 66 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 22364
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.19

In summary, the cut-off frequency is recommended to be 1.19 (k_max = 29)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         45669.8  ...          0.17804                    5
1   0.041         32884.5  ...          0.07235                   13
2   0.082         14183.4  ...          0.01724                   54
3   0.123          3392.0  ...          0.00394                  236
4   0.164           750.9  ...          0.00132                  707
5   0.205            40.4  ...          0.00130                  715
6   0.246           119.5  ...          0.00117                  799
7   0.287            91.5  ...          0.00108                  866
8   0.328            81.3  ...          0.00100                  930
9   0.369            71.5  ...          0.00094                  992
10  0.410            65.3  ...          0.00088                 1054
11  0.451            59.4  ...          0.00083                 1118
12  0.492            55.9  ...          0.00079                 1182
13  0.533            49.9  ...          0.00075                 1245
14  0.574            48.6  ...          0.00071                 1313
15  0.615            45.2  ...          0.00067                 1381
16  0.656            43.6  ...          0.00064                 1456
17  0.697            41.4  ...          0.00061                 1536
18  0.738            39.5  ...          0.00057                 1620
19  0.779            38.6  ...          0.00054                 1712
20  0.820            35.9  ...          0.00051                 1810
21  0.861            35.5  ...          0.00048                 1923
22  0.902            34.5  ...          0.00045                 2053
23  0.943            35.0  ...          0.00042                 2211
24  0.984            34.6  ...          0.00039                 2406
25  1.025            34.3  ...          0.00035                 2664
26  1.066            31.7  ...          0.00031                 2981
27  1.107            32.3  ...          0.00027                 3441
28  1.148            32.9  ...          0.00022                 4247
29  1.189            30.8  ...          0.00016                 5944
30  1.230            32.1  ...          0.00000    18877939533402712

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harpsn ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (66,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.77 to 5.06 m/s
  Final RV_reference RMS: 2.60 m/s
  Success! Processed 66 CCFs with 4 differential modes
  RV range: -4.8 to 5.1 m/s
  eMJD range: 59333.533922 to 59422.641516
  Activity indicator ranges:
    ΔRV_1: RMS = 2.43 m/s
    ΔRV_2: RMS = 4.07 m/s
    ΔRV_3: RMS = 14.62 m/s

Processing HARPS...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445981.51
  Max: 887490.32
  Mean: 747417.25
  Range: 441508.81
  Deepest point: v=0.80 km/s, flux=445981.51
  Highest point: v=12.00 km/s, flux=887490.32
CCF 0 AFTER INVERSION:
  Original range: [0.503, 1.000]
  Inverted range: [0.000, 0.497]
  Line depth (inverted): 0.497
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445744.42
  Max: 887742.09
  Mean: 747360.50
  Range: 441997.67
  Deepest point: v=0.80 km/s, flux=445744.42
  Highest point: v=12.00 km/s, flux=887742.09
CCF 1 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 445955.96
  Max: 887658.38
  Mean: 747100.36
  Range: 441702.42
  Deepest point: v=0.80 km/s, flux=445955.96
  Highest point: v=11.60 km/s, flux=887658.38
CCF 2 AFTER INVERSION:
  Original range: [0.502, 1.000]
  Inverted range: [0.000, 0.498]
  Line depth (inverted): 0.498
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4984
    CCF variation across observations: 0.000287
    CCF center variations: 0.0998 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 15 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 19557
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 0.98

In summary, the cut-off frequency is recommended to be 0.98 (k_max = 24)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         39842.5  ...          0.17053                    5
1   0.041         27850.7  ...          0.06807                   14
2   0.082         11787.9  ...          0.01590                   59
3   0.123          2754.1  ...          0.00381                  244
4   0.164           617.7  ...          0.00164                  569
5   0.205            68.8  ...          0.00159                  585
6   0.246           117.3  ...          0.00144                  647
7   0.287           100.9  ...          0.00132                  706
8   0.328            90.5  ...          0.00123                  761
9   0.369            80.5  ...          0.00114                  815
10  0.410            70.7  ...          0.00108                  866
11  0.451            61.8  ...          0.00102                  912
12  0.492            59.7  ...          0.00097                  963
13  0.533            56.5  ...          0.00091                 1019
14  0.574            52.5  ...          0.00086                 1079
15  0.615            48.0  ...          0.00082                 1134
16  0.656            47.0  ...          0.00078                 1193
17  0.697            46.4  ...          0.00074                 1262
18  0.738            40.1  ...          0.00070                 1325
19  0.779            39.7  ...          0.00067                 1398
20  0.820            38.5  ...          0.00063                 1478
21  0.861            36.4  ...          0.00060                 1562
22  0.902            37.6  ...          0.00056                 1673
23  0.943            35.8  ...          0.00052                 1795
24  0.984            38.3  ...          0.00047                 1978
25  1.025            38.8  ...          0.00042                 2231
26  1.066            32.1  ...          0.00038                 2470
27  1.107            30.4  ...          0.00034                 2768
28  1.148            36.1  ...          0.00027                 3467
29  1.189            33.2  ...          0.00019                 4870
30  1.230            34.0  ...          0.00000    18236126696647972

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for harps ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (15,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -2.09 to 1.99 m/s
  Final RV_reference RMS: 1.36 m/s
  Success! Processed 15 CCFs with 4 differential modes
  RV range: -2.1 to 2.0 m/s
  eMJD range: 59395.677559 to 59422.728510
  Activity indicator ranges:
    ΔRV_1: RMS = 1.51 m/s
    ΔRV_2: RMS = 3.78 m/s
    ΔRV_3: RMS = 14.05 m/s

Processing EXPRES...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398325.50
  Max: 766873.42
  Mean: 650701.16
  Range: 368547.92
  Deepest point: v=0.00 km/s, flux=398325.50
  Highest point: v=11.60 km/s, flux=766873.42
CCF 0 AFTER INVERSION:
  Original range: [0.519, 1.000]
  Inverted range: [0.000, 0.481]
  Line depth (inverted): 0.481
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398578.51
  Max: 766577.89
  Mean: 650627.59
  Range: 367999.38
  Deepest point: v=0.00 km/s, flux=398578.51
  Highest point: v=12.00 km/s, flux=766577.89
CCF 1 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 398497.80
  Max: 766652.22
  Mean: 650865.63
  Range: 368154.42
  Deepest point: v=0.00 km/s, flux=398497.80
  Highest point: v=11.60 km/s, flux=766652.22
CCF 2 AFTER INVERSION:
  Original range: [0.520, 1.000]
  Inverted range: [0.000, 0.480]
  Line depth (inverted): 0.480
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4810
    CCF variation across observations: 0.000229
    CCF center variations: 0.1388 km/s
    CCF center range: 11.6000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 100 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 16828
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.11

In summary, the cut-off frequency is recommended to be 1.11 (k_max = 27)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         32584.7  ...          0.16085                    6
1   0.041         22327.4  ...          0.06664                   14
2   0.082          9742.6  ...          0.01895                   49
3   0.123          2793.1  ...          0.00480                  195
4   0.164           606.3  ...          0.00267                  350
5   0.205           177.2  ...          0.00241                  388
6   0.246           169.3  ...          0.00214                  437
7   0.287           120.8  ...          0.00199                  471
8   0.328           111.2  ...          0.00185                  506
9   0.369            97.9  ...          0.00173                  540
10  0.410            89.1  ...          0.00163                  573
11  0.451            81.8  ...          0.00154                  606
12  0.492            76.5  ...          0.00146                  641
13  0.533            71.4  ...          0.00139                  675
14  0.574            65.4  ...          0.00132                  711
15  0.615            62.3  ...          0.00125                  748
16  0.656            60.4  ...          0.00119                  789
17  0.697            58.1  ...          0.00113                  832
18  0.738            54.9  ...          0.00107                  878
19  0.779            52.7  ...          0.00101                  928
20  0.820            52.2  ...          0.00095                  986
21  0.861            48.8  ...          0.00089                 1047
22  0.902            48.8  ...          0.00084                 1120
23  0.943            46.7  ...          0.00078                 1205
24  0.984            45.7  ...          0.00072                 1306
25  1.025            46.4  ...          0.00065                 1439
26  1.066            45.5  ...          0.00058                 1617
27  1.107            44.5  ...          0.00050                 1875
28  1.148            44.0  ...          0.00041                 2296
29  1.189            43.7  ...          0.00029                 3246
30  1.230            43.9  ...          0.00000    20152102171093292

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for expres ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (100,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.42 to 5.62 m/s
  Final RV_reference RMS: 1.89 m/s
  Success! Processed 100 CCFs with 4 differential modes
  RV range: -4.4 to 5.6 m/s
  eMJD range: 59337.889998 to 59412.689065
  Activity indicator ranges:
    ΔRV_1: RMS = 2.07 m/s
    ΔRV_2: RMS = 3.81 m/s
    ΔRV_3: RMS = 12.13 m/s

Processing NEID...

=== CCF 0 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420010.52
  Max: 793797.91
  Mean: 675380.28
  Range: 373787.38
  Deepest point: v=0.00 km/s, flux=420010.52
  Highest point: v=12.00 km/s, flux=793797.91
CCF 0 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 1 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420052.88
  Max: 793674.27
  Mean: 675357.28
  Range: 373621.40
  Deepest point: v=0.00 km/s, flux=420052.88
  Highest point: v=12.00 km/s, flux=793674.27
CCF 1 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!

=== CCF 2 DETAILED ANALYSIS ===
Raw CCF stats:
  Min: 420077.95
  Max: 793536.41
  Mean: 675440.42
  Range: 373458.46
  Deepest point: v=0.00 km/s, flux=420077.95
  Highest point: v=12.00 km/s, flux=793536.41
CCF 2 AFTER INVERSION:
  Original range: [0.529, 1.000]
  Inverted range: [0.000, 0.471]
  Line depth (inverted): 0.471
  → Ready for FIESTA!
  CCF diagnostics:
    Velocity range: -12.00 to 12.00 km/s
    CCF depth range: 0.0000 to 0.4709
    CCF variation across observations: 0.000139
    CCF center variations: 0.0000 km/s
    CCF center range: 12.0000 to 12.0000 km/s
  Applying FIESTA with k_max=5 to 60 CCFs...

Velocity grid used [-12.00, 12.00]
The median SNR of all CCFs is 15750
The user-defined SNR = 2.0

ξ_photon = 1.23
ξ_normal = 1.23
ξ_individual = 1.23
ξ_timeseries = 1.15

In summary, the cut-off frequency is recommended to be 1.15 (k_max = 28)

        ξ  individual_SNR  ...  modelling noise  recoverable_CCF_SNR
0   0.000         30180.0  ...          0.15981                    6
1   0.041         21029.7  ...          0.06311                   15
2   0.082          8715.0  ...          0.01667                   56
3   0.123          2320.9  ...          0.00384                  243
4   0.164           485.1  ...          0.00179                  523
5   0.205           103.6  ...          0.00163                  572
6   0.246           104.7  ...          0.00146                  639
7   0.287            78.1  ...          0.00136                  689
8   0.328            72.1  ...          0.00126                  742
9   0.369            62.2  ...          0.00118                  791
10  0.410            56.5  ...          0.00111                  840
11  0.451            52.7  ...          0.00105                  891
12  0.492            48.2  ...          0.00099                  941
13  0.533            45.2  ...          0.00094                  992
14  0.574            42.2  ...          0.00089                 1044
15  0.615            39.7  ...          0.00085                 1098
16  0.656            37.7  ...          0.00081                 1156
17  0.697            36.5  ...          0.00077                 1219
18  0.738            34.7  ...          0.00073                 1286
19  0.779            33.7  ...          0.00069                 1360
20  0.820            32.7  ...          0.00065                 1441
21  0.861            31.0  ...          0.00061                 1532
22  0.902            31.5  ...          0.00057                 1642
23  0.943            31.1  ...          0.00053                 1773
24  0.984            29.5  ...          0.00048                 1931
25  1.025            28.9  ...          0.00044                 2121
26  1.066            27.3  ...          0.00039                 2375
27  1.107            30.2  ...          0.00034                 2767
28  1.148            26.7  ...          0.00028                 3372
29  1.189            27.8  ...          0.00020                 4780
30  1.230            27.9  ...          0.00000    16520760815604220

[31 rows x 6 columns]

=== DEBUGGING RV_GAUSS for neid ===
RV_gauss type: <class 'numpy.ndarray'>
RV_gauss shape: (60,)
RV_gauss raw values (first 5): [0. 0. 0. 0. 0.]
RV_gauss min/max/std: 0.000000 / 0.000000 / 0.000000
After conversion to m/s:
RV_gauss_ms min/max/std: 0.000000 / 0.000000 / 0.000000
=== END DEBUG ===

  Debug: RV_gauss stats - mean: 0.00, std: 0.00 m/s
  Debug: RV_gauss range: 0.00 to 0.00 m/s
  WARNING: RV_gauss is essentially flat! This suggests an issue with FIESTA setup.
  Check your CCF data and FIESTA parameters.
  Using first Fourier mode as main RV signal...
  Final RV_reference range: -4.84 to 3.55 m/s
  Final RV_reference RMS: 1.78 m/s
  Success! Processed 60 CCFs with 4 differential modes
  RV range: -4.8 to 3.6 m/s
  eMJD range: 59338.779930 to 59411.906241
  Activity indicator ranges:
    ΔRV_1: RMS = 2.48 m/s
    ΔRV_2: RMS = 3.88 m/s
    ΔRV_3: RMS = 9.84 m/s

Saving activity indicators to .dat files with eMJD times...
  Processing HARPSN...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harpsn_fiesta_rv_gauss.dat (n_obs=66)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harpsn_fiesta_mode1.dat (n_obs=66)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harpsn_fiesta_mode2.dat (n_obs=66)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harpsn_fiesta_mode3.dat (n_obs=66)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harpsn_fiesta_mode4.dat (n_obs=66)
  Processing HARPS...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harps_fiesta_rv_gauss.dat (n_obs=15)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harps_fiesta_mode1.dat (n_obs=15)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harps_fiesta_mode2.dat (n_obs=15)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harps_fiesta_mode3.dat (n_obs=15)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_harps_fiesta_mode4.dat (n_obs=15)
  Processing EXPRES...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_expres_fiesta_rv_gauss.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_expres_fiesta_mode1.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_expres_fiesta_mode2.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_expres_fiesta_mode3.dat (n_obs=100)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_expres_fiesta_mode4.dat (n_obs=100)
  Processing NEID...
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_neid_fiesta_rv_gauss.dat (n_obs=60)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_neid_fiesta_mode1.dat (n_obs=60)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_neid_fiesta_mode2.dat (n_obs=60)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_neid_fiesta_mode3.dat (n_obs=60)
    Saved: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data/DS9_neid_fiesta_mode4.dat (n_obs=60)
All FIESTA files saved with eMJD times!

Creating FIESTA-style plots for DS9...
Saved: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures/DS9_FIESTA_style.png
Completed analysis for DS9

============================================================
FIESTA Analysis Complete!
Plots saved to: /work2/lbuc/iara/GitHub/ESSP/Figures/FIESTA_figures
.dat files saved to: /work2/lbuc/iara/GitHub/PyORBIT_examples/ESSP4/data
============================================================
